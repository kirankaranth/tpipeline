{
  "metainfo": {
    "id": "1",
    "language": "python",
    "fabricId": "3",
    "frontEndLanguage": "sql",
    "mode": "batch",
    "configuration": {
      "common": {
        "type": "record",
        "fields": [
          {
            "name": "SYSPROCESDATUM",
            "kind": {
              "type": "spark_expression",
              "value": "CAST('2024-11-27 14:55:25Z' AS TIMESTAMP)"
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "SYSPEILDATUM",
            "kind": {
              "type": "spark_expression",
              "value": "CAST('2024-11-27' AS DATE)"
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "JOB_CURRENT_DATE",
            "kind": {
              "type": "spark_expression",
              "value": "CAST('2024-11-27' AS DATE)"
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "ETLS_JOBNAME",
            "kind": {
              "type": "string",
              "value": "HLP_AFG_PREMIE"
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "SNAPSHOT_FROM_HISTORY_MAX_VALUE",
            "kind": {
              "type": "string",
              "value": ""
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "read_env",
            "kind": {
              "type": "string",
              "value": "migration"
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "write_env",
            "kind": {
              "type": "string",
              "value": "migration"
            },
            "optional": false,
            "isWorkflowNodeConfiguration": false
          },
          {
            "name": "Loop",
            "kind": {
              "type": "record",
              "fields": [
                {
                  "name": "NUMMER",
                  "kind": {
                    "type": "double",
                    "value": 0
                  },
                  "optional": false,
                  "isWorkflowNodeConfiguration": false
                },
                {
                  "name": "LAATSTE_BRN_PERSOON_ID",
                  "kind": {
                    "type": "string",
                    "value": ""
                  },
                  "optional": false,
                  "isWorkflowNodeConfiguration": false
                },
                {
                  "name": "EERSTE_BRN_PERSOON_ID",
                  "kind": {
                    "type": "string",
                    "value": ""
                  },
                  "optional": false,
                  "isWorkflowNodeConfiguration": false
                }
              ]
            },
            "optional": false,
            "isWorkflowNodeConfiguration": true
          },
          {
            "name": "Loop_1",
            "kind": {
              "type": "record",
              "fields": [
                {
                  "name": "NUMMER",
                  "kind": {
                    "type": "double",
                    "value": 0
                  },
                  "optional": false,
                  "isWorkflowNodeConfiguration": false
                }
              ]
            },
            "optional": false,
            "isWorkflowNodeConfiguration": true
          }
        ]
      },
      "fabrics": {},
      "instances": {
        "default": {}
      },
      "selected": "default"
    },
    "sparkConf": [],
    "hadoopConf": [],
    "codeMode": "sparse",
    "buildSystem": "maven",
    "externalDependencies": [],
    "isImported": true,
    "interimMode": "Full",
    "interimModeEnabled": true,
    "visualCodeInterimMode": "Disabled",
    "recordsLimit": {
      "enabled": false,
      "value": 1000
    },
    "topLevelPackage": "HLP_AFG_PREMIE"
  },
  "connections": [
    {
      "id": "c_99",
      "source": "t1_1",
      "sourcePort": "p1_1",
      "target": "t1_2",
      "targetPort": "p1_2"
    },
    {
      "id": "c_100",
      "source": "t1_2",
      "sourcePort": "p1_3",
      "target": "t2_1",
      "targetPort": "p2_1"
    },
    {
      "id": "c_101",
      "source": "t1_2",
      "sourcePort": "p1_3",
      "target": "t51_1",
      "targetPort": "p51_1"
    }
  ],
  "processes": {
    "t1_1": {
      "id": "t1_1",
      "component": "Source",
      "metadata": {
        "label": "source_hlp_premie_parameters",
        "slug": "source_hlp_premie_parameters",
        "phase": 1,
        "cache": false,
        "detailedStats": false,
        "isImported": true
      },
      "ports": {
        "inputs": [],
        "outputs": [
          {
            "id": "p1_1",
            "slug": "HLP_PREMIE_PARAMETERS"
          }
        ],
        "selectedInputFields": [],
        "isCustomOutputSchema": false
      },
      "properties": {
        "datasetId": "datasets/hlp_afg_premie_il_hlp_hlp_premie_parameters"
      },
      "componentInfo": null
    },
    "t1_2": {
      "id": "t1_2",
      "component": "Script",
      "metadata": {
        "label": "User_Written",
        "slug": "User_Written",
        "phase": 1,
        "cache": false,
        "detailedStats": false,
        "isImported": true,
        "comment": "Bepalen blokgrootte\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APL\nOriginal transform name: User Written\nOriginal output dataset names:\n- W6GCCZF"
      },
      "ports": {
        "inputs": [
          {
            "id": "p1_2",
            "slug": "HLP_PREMIE_PARAMETERS"
          }
        ],
        "outputs": [
          {
            "id": "p1_3",
            "slug": "blokgrootte",
            "schema": {
              "type": "struct",
              "fields": [
                {
                  "name": "BLOKNUMMER",
                  "type": "double",
                  "nullable": true,
                  "metadata": {}
                },
                {
                  "name": "start_brn_persoon_id",
                  "type": "double",
                  "nullable": true,
                  "metadata": {}
                },
                {
                  "name": "eind_brn_persoon_id",
                  "type": "double",
                  "nullable": true,
                  "metadata": {}
                }
              ]
            }
          }
        ],
        "selectedInputFields": [],
        "isCustomOutputSchema": true
      },
      "properties": {
        "script": "# Original transform id: A5H5U7VN.BX005APL\n# Original transform name: User Written\n# Original transform description: Bepalen blokgrootte\n# \n# Auto-generated input/output variables.\n# Variables for input ports\nHLP_PREMIE_PARAMETERS.createOrReplaceTempView('_INPUT')\n_input = '_INPUT'\nHLP_PREMIE_PARAMETERS.createOrReplaceTempView('_INPUT1')\n_input1 = '_INPUT1'\n# Variables for output ports\n_output = '_OUTPUT'\n# Original code:\n#  %LET BLOKGROOTTE = 2000000; /* 2 miljoen, dus ongeveer 25 loops in PRD */\n# \n# /* Tellen aantal brn_persoon_id regels */\n# proc sql;\n#   create table sort_brn_persoon as\n#   select BRN_PERSOON_ID,\n#          COUNT(*) as AANTAL_BRN_PERSOON\n#    from &_INPUT\n#   group by BRN_PERSOON_ID;\n# quit;\n# \n# /* Aanmaken blokken van aantallen bron persoon id's zoals aangegeven in de parameter */\n# /* Van belang is dat er groepen worden gemaakt met gehele bron_persoon_id's */\n# /* en niet dat dezelfde brn_persoon_id's in verschillende blokken komen */\n# data &_OUTPUT(keep=bloknummer start_brn_persoon_id eind_brn_persoon_id); \n#   retain start_brn_persoon_id eind_brn_persoon_id 0;\n#   set sort_brn_persoon end=eof;\n#   sum_aantal_brn_persoon + aantal_brn_persoon;\n#   if (sum_aantal_brn_persoon > &BLOKGROOTTE) or eof then do;\n#      start_brn_persoon_id = eind_brn_persoon_id;\n#      eind_brn_persoon_id = BRN_PERSOON_ID;\n#      bloknummer + 1;\n#      output;\n#      sum_aantal_brn_persoon = 0;\n#   end;\n# run;\n# \n# %put _user_;\n# Auto-generated variables.\n# Variables for output ports\nblokgrootte = spark.table(\"_OUTPUT\")",
        "scriptMethodHeader": null,
        "scriptMethodFooter": null
      },
      "componentInfo": null
    },
    "t2_1": {
      "id": "t2_1",
      "component": "TableIterator",
      "metadata": {
        "label": "Loop",
        "slug": "Loop",
        "phase": 2,
        "cache": false,
        "detailedStats": false,
        "isImported": false,
        "configPathInPipelineConfig": [
          "Loop"
        ]
      },
      "ports": {
        "inputs": [
          {
            "id": "p2_1",
            "slug": "blokgrootte"
          }
        ],
        "outputs": [],
        "selectedInputFields": [],
        "isCustomOutputSchema": false
      },
      "properties": {
        "metagemProperty": {
          "availableColumnNames": [
            "BLOKNUMMER",
            "EIND_BRN_PERSOON_ID",
            "START_BRN_PERSOON_ID"
          ],
          "availableConfigFieldNames": [
            "NUMMER",
            "LAATSTE_BRN_PERSOON_ID",
            "EERSTE_BRN_PERSOON_ID"
          ],
          "numberOfThreads": "1",
          "maxIteration": "999999999",
          "parallelismEnabled": false,
          "configToColumnMap": [
            {
              "configName": "NUMMER",
              "columnName": "BLOKNUMMER"
            },
            {
              "configName": "LAATSTE_BRN_PERSOON_ID",
              "columnName": "EIND_BRN_PERSOON_ID"
            },
            {
              "configName": "EERSTE_BRN_PERSOON_ID",
              "columnName": "START_BRN_PERSOON_ID"
            }
          ]
        }
      },
      "componentInfo": {
        "gemId": "gitUri=http://gitserver:3000/XIUGo8J6_team_2/XIUGo8J6_project_4.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=4&path=gems/TableIterator",
        "projectName": "ProphecySparkBasicsPython"
      },
      "connections": [
        {
          "id": "c_94",
          "source": "t2_1",
          "sourcePort": "p2_1",
          "target": "t2_cfi_1",
          "targetPort": "p2_cfi_1"
        },
        {
          "id": "c_1",
          "source": "t4_1",
          "sourcePort": "p4_1",
          "target": "t4_2",
          "targetPort": "p4_2"
        },
        {
          "id": "c_2",
          "source": "t5_1",
          "sourcePort": "p5_1",
          "target": "t5_2",
          "targetPort": "p5_2"
        },
        {
          "id": "c_3",
          "source": "t5_2",
          "sourcePort": "p5_3",
          "target": "t5_3",
          "targetPort": "p5_4"
        },
        {
          "id": "c_4",
          "source": "t4_2",
          "sourcePort": "p4_3",
          "target": "t6_1",
          "targetPort": "p6_1"
        },
        {
          "id": "c_5",
          "source": "t5_3",
          "sourcePort": "p5_5",
          "target": "t6_1",
          "targetPort": "p6_2"
        },
        {
          "id": "c_6",
          "source": "t7_1",
          "sourcePort": "p7_1",
          "target": "t7_2",
          "targetPort": "p7_2"
        },
        {
          "id": "c_7",
          "source": "t8_1",
          "sourcePort": "p8_1",
          "target": "t8_2",
          "targetPort": "p8_2"
        },
        {
          "id": "c_8",
          "source": "t8_2",
          "sourcePort": "p8_3",
          "target": "t8_3",
          "targetPort": "p8_4"
        },
        {
          "id": "c_9",
          "source": "t8_3",
          "sourcePort": "p8_5",
          "target": "t9_1",
          "targetPort": "p9_1"
        },
        {
          "id": "c_10",
          "source": "t6_1",
          "sourcePort": "p6_3",
          "target": "t9_1",
          "targetPort": "p9_2"
        },
        {
          "id": "c_11",
          "source": "t7_2",
          "sourcePort": "p7_3",
          "target": "t9_1",
          "targetPort": "p9_3"
        },
        {
          "id": "c_12",
          "source": "t9_1",
          "sourcePort": "p9_4",
          "target": "t9_2",
          "targetPort": "p9_5"
        },
        {
          "id": "c_13",
          "source": "t9_2",
          "sourcePort": "p9_6",
          "target": "t10_1",
          "targetPort": "p10_1"
        },
        {
          "id": "c_14",
          "source": "t10_1",
          "sourcePort": "p10_2",
          "target": "t10_2",
          "targetPort": "p10_3"
        },
        {
          "id": "c_15",
          "source": "t10_2",
          "sourcePort": "p10_4",
          "target": "t10_3",
          "targetPort": "p10_5"
        },
        {
          "id": "c_16",
          "source": "t11_1",
          "sourcePort": "p11_1",
          "target": "t11_2",
          "targetPort": "p11_2"
        },
        {
          "id": "c_17",
          "source": "t10_3",
          "sourcePort": "p10_6",
          "target": "t12_1",
          "targetPort": "p12_1"
        },
        {
          "id": "c_18",
          "source": "t11_2",
          "sourcePort": "p11_3",
          "target": "t12_1",
          "targetPort": "p12_2"
        },
        {
          "id": "c_19",
          "source": "t6_1",
          "sourcePort": "p6_3",
          "target": "t13_1",
          "targetPort": "p13_1"
        },
        {
          "id": "c_20",
          "source": "t11_2",
          "sourcePort": "p11_3",
          "target": "t13_1",
          "targetPort": "p13_2"
        },
        {
          "id": "c_21",
          "source": "t12_1",
          "sourcePort": "p12_3",
          "target": "t14_1",
          "targetPort": "p14_1"
        },
        {
          "id": "c_22",
          "source": "t15_1",
          "sourcePort": "p15_1",
          "target": "t15_2",
          "targetPort": "p15_2"
        },
        {
          "id": "c_23",
          "source": "t16_1",
          "sourcePort": "p16_1",
          "target": "t16_2",
          "targetPort": "p16_2"
        },
        {
          "id": "c_24",
          "source": "t17_1",
          "sourcePort": "p17_1",
          "target": "t17_2",
          "targetPort": "p17_2"
        },
        {
          "id": "c_25",
          "source": "t15_2",
          "sourcePort": "p15_3",
          "target": "t18_1",
          "targetPort": "p18_1"
        },
        {
          "id": "c_26",
          "source": "t16_2",
          "sourcePort": "p16_3",
          "target": "t18_1",
          "targetPort": "p18_2"
        },
        {
          "id": "c_27",
          "source": "t17_2",
          "sourcePort": "p17_3",
          "target": "t18_1",
          "targetPort": "p18_3"
        },
        {
          "id": "c_28",
          "source": "t18_1",
          "sourcePort": "p18_4",
          "target": "t18_2",
          "targetPort": "p18_5"
        },
        {
          "id": "c_29",
          "source": "t18_2",
          "sourcePort": "p18_6",
          "target": "t19_1",
          "targetPort": "p19_1"
        },
        {
          "id": "c_30",
          "source": "t18_2",
          "sourcePort": "p18_6",
          "target": "t19_2",
          "targetPort": "p19_3"
        },
        {
          "id": "c_31",
          "source": "t14_1",
          "sourcePort": "p14_2",
          "target": "t20_1",
          "targetPort": "p20_1"
        },
        {
          "id": "c_32",
          "source": "t19_1",
          "sourcePort": "p19_2",
          "target": "t20_1",
          "targetPort": "p20_2"
        },
        {
          "id": "c_33",
          "source": "t19_2",
          "sourcePort": "p19_4",
          "target": "t20_1",
          "targetPort": "p20_3"
        },
        {
          "id": "c_34",
          "source": "t14_1",
          "sourcePort": "p14_2",
          "target": "t21_1",
          "targetPort": "p21_1"
        },
        {
          "id": "c_35",
          "source": "t19_1",
          "sourcePort": "p19_2",
          "target": "t21_1",
          "targetPort": "p21_2"
        },
        {
          "id": "c_36",
          "source": "t19_2",
          "sourcePort": "p19_4",
          "target": "t21_1",
          "targetPort": "p21_3"
        },
        {
          "id": "c_37",
          "source": "t14_1",
          "sourcePort": "p14_2",
          "target": "t22_1",
          "targetPort": "p22_1"
        },
        {
          "id": "c_38",
          "source": "t19_1",
          "sourcePort": "p19_2",
          "target": "t22_1",
          "targetPort": "p22_2"
        },
        {
          "id": "c_39",
          "source": "t19_2",
          "sourcePort": "p19_4",
          "target": "t22_1",
          "targetPort": "p22_3"
        },
        {
          "id": "c_40",
          "source": "t20_1",
          "sourcePort": "p20_4",
          "target": "t23_1",
          "targetPort": "p23_1"
        },
        {
          "id": "c_41",
          "source": "t21_1",
          "sourcePort": "p21_4",
          "target": "t23_1",
          "targetPort": "p23_2"
        },
        {
          "id": "c_42",
          "source": "t22_1",
          "sourcePort": "p22_4",
          "target": "t23_1",
          "targetPort": "p23_3"
        },
        {
          "id": "c_43",
          "source": "t23_1",
          "sourcePort": "p23_4",
          "target": "t23_2",
          "targetPort": "p23_5"
        },
        {
          "id": "c_44",
          "source": "t23_2",
          "sourcePort": "p23_6",
          "target": "t24_1",
          "targetPort": "p24_1"
        },
        {
          "id": "c_45",
          "source": "t25_1",
          "sourcePort": "p25_1",
          "target": "t25_2",
          "targetPort": "p25_2"
        },
        {
          "id": "c_46",
          "source": "t24_1",
          "sourcePort": "p24_2",
          "target": "t26_1",
          "targetPort": "p26_1"
        },
        {
          "id": "c_47",
          "source": "t25_2",
          "sourcePort": "p25_3",
          "target": "t26_1",
          "targetPort": "p26_2"
        },
        {
          "id": "c_48",
          "source": "t12_1",
          "sourcePort": "p12_3",
          "target": "t27_1",
          "targetPort": "p27_1"
        },
        {
          "id": "c_49",
          "source": "t15_2",
          "sourcePort": "p15_3",
          "target": "t27_1",
          "targetPort": "p27_2"
        },
        {
          "id": "c_50",
          "source": "t16_2",
          "sourcePort": "p16_3",
          "target": "t27_1",
          "targetPort": "p27_3"
        },
        {
          "id": "c_51",
          "source": "t25_2",
          "sourcePort": "p25_3",
          "target": "t27_1",
          "targetPort": "p27_4"
        },
        {
          "id": "c_52",
          "source": "t28_1",
          "sourcePort": "p28_1",
          "target": "t28_2",
          "targetPort": "p28_2"
        },
        {
          "id": "c_53",
          "source": "t28_2",
          "sourcePort": "p28_3",
          "target": "t29_1",
          "targetPort": "p29_1"
        },
        {
          "id": "c_54",
          "source": "t29_1",
          "sourcePort": "p29_2",
          "target": "t29_2",
          "targetPort": "p29_3"
        },
        {
          "id": "c_55",
          "source": "t26_1",
          "sourcePort": "p26_3",
          "target": "t30_1",
          "targetPort": "p30_1"
        },
        {
          "id": "c_56",
          "source": "t29_2",
          "sourcePort": "p29_4",
          "target": "t30_1",
          "targetPort": "p30_2"
        },
        {
          "id": "c_57",
          "source": "t26_1",
          "sourcePort": "p26_3",
          "target": "t31_1",
          "targetPort": "p31_1"
        },
        {
          "id": "c_58",
          "source": "t29_2",
          "sourcePort": "p29_4",
          "target": "t31_1",
          "targetPort": "p31_2"
        },
        {
          "id": "c_59",
          "source": "t26_1",
          "sourcePort": "p26_3",
          "target": "t32_1",
          "targetPort": "p32_1"
        },
        {
          "id": "c_60",
          "source": "t29_2",
          "sourcePort": "p29_4",
          "target": "t32_1",
          "targetPort": "p32_2"
        },
        {
          "id": "c_61",
          "source": "t30_1",
          "sourcePort": "p30_3",
          "target": "t33_1",
          "targetPort": "p33_1"
        },
        {
          "id": "c_62",
          "source": "t31_1",
          "sourcePort": "p31_3",
          "target": "t33_1",
          "targetPort": "p33_2"
        },
        {
          "id": "c_63",
          "source": "t32_1",
          "sourcePort": "p32_3",
          "target": "t33_1",
          "targetPort": "p33_3"
        },
        {
          "id": "c_64",
          "source": "t33_1",
          "sourcePort": "p33_4",
          "target": "t33_2",
          "targetPort": "p33_5"
        },
        {
          "id": "c_65",
          "source": "t33_2",
          "sourcePort": "p33_6",
          "target": "t34_1",
          "targetPort": "p34_1"
        },
        {
          "id": "c_66",
          "source": "t35_1",
          "sourcePort": "p35_1",
          "target": "t35_2",
          "targetPort": "p35_2"
        },
        {
          "id": "c_67",
          "source": "t34_1",
          "sourcePort": "p34_2",
          "target": "t36_1",
          "targetPort": "p36_1"
        },
        {
          "id": "c_68",
          "source": "t35_2",
          "sourcePort": "p35_3",
          "target": "t36_1",
          "targetPort": "p36_2"
        },
        {
          "id": "c_69",
          "source": "t23_2",
          "sourcePort": "p23_6",
          "target": "t37_1",
          "targetPort": "p37_1"
        },
        {
          "id": "c_70",
          "source": "t24_1",
          "sourcePort": "p24_2",
          "target": "t37_1",
          "targetPort": "p37_2"
        },
        {
          "id": "c_71",
          "source": "t26_1",
          "sourcePort": "p26_3",
          "target": "t37_1",
          "targetPort": "p37_3"
        },
        {
          "id": "c_72",
          "source": "t28_2",
          "sourcePort": "p28_3",
          "target": "t37_1",
          "targetPort": "p37_4"
        },
        {
          "id": "c_73",
          "source": "t33_2",
          "sourcePort": "p33_6",
          "target": "t37_1",
          "targetPort": "p37_5"
        },
        {
          "id": "c_74",
          "source": "t35_2",
          "sourcePort": "p35_3",
          "target": "t37_1",
          "targetPort": "p37_6"
        },
        {
          "id": "c_75",
          "source": "t36_1",
          "sourcePort": "p36_3",
          "target": "t38_1",
          "targetPort": "p38_1"
        },
        {
          "id": "c_76",
          "source": "t39_1",
          "sourcePort": "p39_1",
          "target": "t39_2",
          "targetPort": "p39_2"
        },
        {
          "id": "c_77",
          "source": "t38_1",
          "sourcePort": "p38_2",
          "target": "t40_1",
          "targetPort": "p40_1"
        },
        {
          "id": "c_78",
          "source": "t39_2",
          "sourcePort": "p39_3",
          "target": "t40_1",
          "targetPort": "p40_2"
        },
        {
          "id": "c_79",
          "source": "t41_1",
          "sourcePort": "p41_1",
          "target": "t41_2",
          "targetPort": "p41_2"
        },
        {
          "id": "c_80",
          "source": "t40_1",
          "sourcePort": "p40_3",
          "target": "t42_1",
          "targetPort": "p42_1"
        },
        {
          "id": "c_81",
          "source": "t41_2",
          "sourcePort": "p41_3",
          "target": "t42_1",
          "targetPort": "p42_2"
        },
        {
          "id": "c_82",
          "source": "t34_1",
          "sourcePort": "p34_2",
          "target": "t43_1",
          "targetPort": "p43_1"
        },
        {
          "id": "c_83",
          "source": "t36_1",
          "sourcePort": "p36_3",
          "target": "t43_1",
          "targetPort": "p43_2"
        },
        {
          "id": "c_84",
          "source": "t39_2",
          "sourcePort": "p39_3",
          "target": "t43_1",
          "targetPort": "p43_3"
        },
        {
          "id": "c_85",
          "source": "t41_2",
          "sourcePort": "p41_3",
          "target": "t43_1",
          "targetPort": "p43_4"
        },
        {
          "id": "c_86",
          "source": "t42_1",
          "sourcePort": "p42_3",
          "target": "t44_1",
          "targetPort": "p44_1"
        },
        {
          "id": "c_87",
          "source": "t45_1",
          "sourcePort": "p45_1",
          "target": "t45_2",
          "targetPort": "p45_2"
        },
        {
          "id": "c_88",
          "source": "t44_1",
          "sourcePort": "p44_2",
          "target": "t46_1",
          "targetPort": "p46_1"
        },
        {
          "id": "c_89",
          "source": "t45_2",
          "sourcePort": "p45_3",
          "target": "t46_1",
          "targetPort": "p46_2"
        },
        {
          "id": "c_90",
          "source": "t47_1",
          "sourcePort": "p47_1",
          "target": "t47_2",
          "targetPort": "p47_2"
        },
        {
          "id": "c_91",
          "source": "t46_1",
          "sourcePort": "p46_3",
          "target": "t48_1",
          "targetPort": "p48_1"
        },
        {
          "id": "c_92",
          "source": "t47_2",
          "sourcePort": "p47_3",
          "target": "t48_1",
          "targetPort": "p48_2"
        },
        {
          "id": "c_93",
          "source": "t48_1",
          "sourcePort": "p48_3",
          "target": "t49_1",
          "targetPort": "p49_1"
        }
      ],
      "processes": {
        "t2_cfi_1": {
          "id": "t2_cfi_1",
          "component": "ControlFlowInput",
          "metadata": {
            "label": "TableIterator_Input",
            "slug": "TableIterator_Input",
            "phase": 0,
            "cache": false,
            "detailedStats": false,
            "isImported": false,
            "visualProperty": {
              "isHidden": true
            }
          },
          "ports": {
            "inputs": [
              {
                "id": "p2_cfi_1",
                "slug": "blokgrootte"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "minNumberOfInPorts": 1,
            "allowOutportAddDelete": true,
            "description": "",
            "allowInportAddDelete": true,
            "minNumberOfOutPorts": 0,
            "allowOutportRename": true,
            "allowInportRename": true
          },
          "componentInfo": null
        },
        "t2_cfo_1": {
          "id": "t2_cfo_1",
          "component": "ControlFlowOutput",
          "metadata": {
            "label": "TableIterator_Output",
            "slug": "TableIterator_Output",
            "phase": 0,
            "cache": false,
            "detailedStats": false,
            "isImported": false,
            "visualProperty": {
              "isHidden": true
            }
          },
          "ports": {
            "inputs": [],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "minNumberOfInPorts": 0,
            "allowOutportAddDelete": true,
            "description": "",
            "allowInportAddDelete": true,
            "minNumberOfOutPorts": 0,
            "allowOutportRename": true,
            "allowInportRename": true
          },
          "componentInfo": null
        },
        "t3_1": {
          "id": "t3_1",
          "component": "Script",
          "metadata": {
            "label": "User_Written_1",
            "slug": "User_Written_1",
            "phase": 3,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "%let blokid = &NUMMER;\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APN\nOriginal transform name: User Written\nOriginal output dataset names:\n- W6HDQYH"
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p3_1",
                "slug": "blockid",
                "schema": {
                  "type": "struct",
                  "fields": []
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "script": "# Original transform id: A5H5U7VN.BX005APN\n# Original transform name: User Written\n# Original transform description: %let blokid = &NUMMER;\n# \n# Auto-generated input/output variables.\n# Variables for output ports\n_output = '_OUTPUT'\nblokid = nummer\n# Auto-generated variables.\n# Variables for output ports\nblockid = spark.table(\"_OUTPUT\")",
            "scriptMethodHeader": null,
            "scriptMethodFooter": null
          },
          "componentInfo": null
        },
        "t4_1": {
          "id": "t4_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie",
            "slug": "source_lnk_premie",
            "phase": 4,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p4_1",
                "slug": "LNK_PREMIE"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie"
          },
          "componentInfo": null
        },
        "t4_2": {
          "id": "t4_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie",
            "slug": "Snapshot_uit_historie",
            "phase": 4,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APO\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_lnk_premie"
          },
          "ports": {
            "inputs": [
              {
                "id": "p4_2",
                "slug": "LNK_PREMIE"
              }
            ],
            "outputs": [
              {
                "id": "p4_3",
                "slug": "snap_lnk_premie",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "TABELPREMIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_ID,OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,REFERENTIEPREMIE_BDG,FABRIEKSPRIJS_BDG,COMMERCIELE_TOESLAG_BDG,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_VERWIJDER_DTD,EDWH_PROCES_DTD,EIGEN_RISICO_REGELING_ID,TABELPREMIE_IDC,LEEFTIJD_VAN,LEEFTIJD_TOT_MET",
            "history_key": "LNK_PREMIE_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t5_1": {
          "id": "t5_1",
          "component": "Source",
          "metadata": {
            "label": "source_datum",
            "slug": "source_datum",
            "phase": 5,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p5_1",
                "slug": "DATUM"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_datum"
          },
          "componentInfo": null
        },
        "t5_2": {
          "id": "t5_2",
          "component": "Filter",
          "metadata": {
            "label": "Extract_filter",
            "slug": "Extract_filter",
            "phase": 5,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Datum start einde jaar\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APP\nOriginal transform name: Extract\nOriginal output dataset names:\n- W41V9JK"
          },
          "ports": {
            "inputs": [
              {
                "id": "p5_2",
                "slug": "DATUM"
              }
            ],
            "outputs": [
              {
                "id": "p5_3",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "condition": {
              "format": "sql",
              "expression": "COALESCE(JAAR_NMR, CAST('-inf' AS FLOAT)) >= 2000 AND COALESCE(JAAR_NMR, CAST('-inf' AS FLOAT)) <= COALESCE(YEAR(expr('$SYSPEILDATUM')) + 1, CAST('-inf' AS FLOAT))"
            }
          },
          "componentInfo": null
        },
        "t5_3": {
          "id": "t5_3",
          "component": "Aggregate",
          "metadata": {
            "label": "Extract_aggregate",
            "slug": "Extract_aggregate",
            "phase": 5,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Datum start einde jaar\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APP\nOriginal transform name: Extract\nOriginal output dataset names:\n- W41V9JK"
          },
          "ports": {
            "inputs": [
              {
                "id": "p5_4",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p5_5",
                "slug": "Extract_datum"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "allIns": false,
            "doPivot": false,
            "aggregate": [
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "MAX(SAS_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "MIN(SAS_DTM)"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "allowSelection": true,
            "pivotColumn": null,
            "pivotValues": [],
            "activeTab": "aggregate",
            "columnsSelector": [],
            "groupBy": [
              {
                "target": "JAAR_NMR",
                "expression": {
                  "format": "sql",
                  "expression": "JAAR_NMR"
                },
                "description": "",
                "_row_id": ""
              }
            ]
          },
          "componentInfo": null
        },
        "t6_1": {
          "id": "t6_1",
          "component": "Join",
          "metadata": {
            "label": "Join",
            "slug": "Join",
            "phase": 6,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Opsplitsen ingang eind datum per jaar\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APQ\nOriginal transform name: Join\nOriginal output dataset names:\n- W4XI5Z2"
          },
          "ports": {
            "inputs": [
              {
                "id": "p6_1",
                "slug": "snap_lnk_premie"
              },
              {
                "id": "p6_2",
                "slug": "Extract_datum"
              }
            ],
            "outputs": [
              {
                "id": "p6_3",
                "slug": "Join_premie_datum"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "Extract_datum",
                "expression": {
                  "format": "sql",
                  "expression": "True"
                },
                "joinType": "cross"
              }
            ],
            "expressions": [
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_PEIL_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.EDWH_PEIL_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_PROCES_DTD",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.EDWH_PROCES_DTD"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_VERWIJDER_DTD",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.EDWH_VERWIJDER_DTD"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(snap_lnk_premie.EIND_DTM, Extract_datum.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(snap_lnk_premie.INGANG_DTM, Extract_datum.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LNK_PREMIE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.LNK_PREMIE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "snap_lnk_premie.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p6_1",
                "alias": "snap_lnk_premie",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p6_2",
                "alias": "Extract_datum",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": {
              "format": "sql",
              "expression": "COALESCE(snap_lnk_premie.INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(Extract_datum.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(snap_lnk_premie.EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(Extract_datum.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
            },
            "headAlias": "snap_lnk_premie"
          },
          "componentInfo": null
        },
        "t7_1": {
          "id": "t7_1",
          "component": "Source",
          "metadata": {
            "label": "source_label",
            "slug": "source_label",
            "phase": 7,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p7_1",
                "slug": "LABEL"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_label"
          },
          "componentInfo": null
        },
        "t7_2": {
          "id": "t7_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_1",
            "slug": "Snapshot_uit_historie_1",
            "phase": 7,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APR\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- W5ADZEM"
          },
          "ports": {
            "inputs": [
              {
                "id": "p7_2",
                "slug": "LABEL"
              }
            ],
            "outputs": [
              {
                "id": "p7_3",
                "slug": "SNP_LABEL",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_KEY",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_OMSCHRIJVING",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_OMSCHRIJVING_KORT",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ZORGVERZEKERING_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LABEL_ID,LABEL_KEY,LABEL_OMSCHRIJVING,LABEL_OMSCHRIJVING_KORT,EDWH_RESOURCE_ID,LABEL_ZORGVERZEKERING_IDC,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD",
            "history_key": "LABEL_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t8_1": {
          "id": "t8_1",
          "component": "Source",
          "metadata": {
            "label": "source_hlp_premie_parameters_1",
            "slug": "source_hlp_premie_parameters_1",
            "phase": 8,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p8_1",
                "slug": "HLP_PREMIE_PARAMETERS"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_hlp_hlp_premie_parameters"
          },
          "componentInfo": null
        },
        "t8_2": {
          "id": "t8_2",
          "component": "Filter",
          "metadata": {
            "label": "Extract_filter_1",
            "slug": "Extract_filter_1",
            "phase": 8,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Lezen per blok\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APS\nOriginal transform name: Extract\nOriginal output dataset names:\n- W6P80Z8"
          },
          "ports": {
            "inputs": [
              {
                "id": "p8_2",
                "slug": "HLP_PREMIE_PARAMETERS"
              }
            ],
            "outputs": [
              {
                "id": "p8_3",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "condition": {
              "format": "sql",
              "expression": "BRN_PERSOON_ID > '$EERSTE_BRN_PERSOON_ID' AND BRN_PERSOON_ID <= '$LAATSTE_BRN_PERSOON_ID'"
            }
          },
          "componentInfo": null
        },
        "t8_3": {
          "id": "t8_3",
          "component": "Reformat",
          "metadata": {
            "label": "Extract_reformat",
            "slug": "Extract_reformat",
            "phase": 8,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Lezen per blok\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APS\nOriginal transform name: Extract\nOriginal output dataset names:\n- W6P80Z8"
          },
          "ports": {
            "inputs": [
              {
                "id": "p8_4",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p8_5",
                "slug": "Extract_per_blok"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ]
          },
          "componentInfo": null
        },
        "t9_1": {
          "id": "t9_1",
          "component": "Join",
          "metadata": {
            "label": "Join_join",
            "slug": "Join_join",
            "phase": 9,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "premie - persoon\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APT\nOriginal transform name: Join\nOriginal output dataset names:\n- Join_pers_premie"
          },
          "ports": {
            "inputs": [
              {
                "id": "p9_1",
                "slug": "Extract_per_blok"
              },
              {
                "id": "p9_2",
                "slug": "Join_premie_datum"
              },
              {
                "id": "p9_3",
                "slug": "SNP_LABEL"
              }
            ],
            "outputs": [
              {
                "id": "p9_4",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "Join_premie_datum",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.COLLECTIVITEIT_OVEREENKOMST_ID <=> Join_premie_datum.OVEREENKOMST_ID AND Extract_per_blok.PRODUCTSET_SOORT_ID <=> Join_premie_datum.PRODUCTSET_SOORT_ID AND Extract_per_blok.BOUWSTEEN_ID <=> Join_premie_datum.BOUWSTEEN_ID AND COALESCE(Extract_per_blok.INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(Join_premie_datum.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(Extract_per_blok.EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(Join_premie_datum.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND (Join_premie_datum.EIGEN_RISICO_REGELING_ID IS NOT NULL AND Extract_per_blok.EIGEN_RISICO_REGELING_ID <=> Join_premie_datum.EIGEN_RISICO_REGELING_ID OR Join_premie_datum.EIGEN_RISICO_REGELING_ID IS NULL)"
                },
                "joinType": "left_outer"
              },
              {
                "alias": "SNP_LABEL",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.LABEL_ID <=> SNP_LABEL.LABEL_ID"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(Extract_per_blok.EIND_DTM, Join_premie_datum.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(Extract_per_blok.INGANG_DTM, Join_premie_datum.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_KEY",
                "expression": {
                  "format": "sql",
                  "expression": "SNP_LABEL.LABEL_KEY"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REKEN_GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "CASE\n    WHEN DAY(GREATEST(Extract_per_blok.INGANG_DTM, Join_premie_datum.INGANG_DTM)) <=> DAY(Extract_per_blok.GEBOORTE_DTM) AND MONTH(GREATEST(Extract_per_blok.INGANG_DTM, Join_premie_datum.INGANG_DTM)) <=> MONTH(Extract_per_blok.GEBOORTE_DTM)\n    THEN Extract_per_blok.GEBOORTE_DTM + 1\n    ELSE Extract_per_blok.GEBOORTE_DTM\nEND"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "Join_premie_datum.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "Extract_per_blok.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p9_1",
                "alias": "Extract_per_blok",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p9_2",
                "alias": "Join_premie_datum",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p9_3",
                "alias": "SNP_LABEL",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "Extract_per_blok"
          },
          "componentInfo": null
        },
        "t9_2": {
          "id": "t9_2",
          "component": "OrderBy",
          "metadata": {
            "label": "Join_orderby",
            "slug": "Join_orderby",
            "phase": 9,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "premie - persoon\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APT\nOriginal transform name: Join\nOriginal output dataset names:\n- Join_pers_premie"
          },
          "ports": {
            "inputs": [
              {
                "id": "p9_5",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p9_6",
                "slug": "Join_pers_premie"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "orders": [
              {
                "expression": {
                  "format": "sql",
                  "expression": "BOUWSTEEN_ID"
                },
                "sortType": "asc"
              },
              {
                "expression": {
                  "format": "sql",
                  "expression": "BRN_PERSOON_ID"
                },
                "sortType": "asc"
              },
              {
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "sortType": "asc"
              },
              {
                "expression": {
                  "format": "sql",
                  "expression": "INGANG_DTM"
                },
                "sortType": "asc"
              },
              {
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_ID"
                },
                "sortType": "asc"
              },
              {
                "expression": {
                  "format": "sql",
                  "expression": "LAND_ID"
                },
                "sortType": "asc"
              },
              {
                "expression": {
                  "format": "sql",
                  "expression": "PRODUCTSET_SOORT_ID"
                },
                "sortType": "asc"
              }
            ]
          },
          "componentInfo": null
        },
        "t10_1": {
          "id": "t10_1",
          "component": "Filter",
          "metadata": {
            "label": "Extract_filter_2",
            "slug": "Extract_filter_2",
            "phase": 10,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "periode\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APU\nOriginal transform name: Extract\nOriginal output dataset names:\n- periode_pers"
          },
          "ports": {
            "inputs": [
              {
                "id": "p10_1",
                "slug": "Join_pers_premie"
              }
            ],
            "outputs": [
              {
                "id": "p10_2",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "condition": {
              "format": "sql",
              "expression": "COALESCE(EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(DATE_TRUNC('YEAR', expr('$SYSPEILDATUM') + INTERVAL -5 YEAR), CAST ('0001-01-01' AS TIMESTAMP)) AND COALESCE(INGANG_DTM, CAST ('0001-01-01' AS DATE)) < COALESCE(DATE_TRUNC('YEAR', expr('$SYSPEILDATUM') + INTERVAL 2 YEAR) - make_dt_interval(0, 0, 0, 1), CAST ('0001-01-01' AS TIMESTAMP))"
            }
          },
          "componentInfo": null
        },
        "t10_2": {
          "id": "t10_2",
          "component": "Reformat",
          "metadata": {
            "label": "Extract_reformat_1",
            "slug": "Extract_reformat_1",
            "phase": 10,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "periode\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APU\nOriginal transform name: Extract\nOriginal output dataset names:\n- periode_pers"
          },
          "ports": {
            "inputs": [
              {
                "id": "p10_3",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p10_4",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "cast(\nCASE\n    WHEN COALESCE(EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(DATE_TRUNC('YEAR', expr('$JOB_CURRENT_DATE') + INTERVAL 2 YEAR) - make_dt_interval(0, 0, 0, 1), CAST ('0001-01-01' AS TIMESTAMP))\n    THEN DATE_TRUNC('YEAR', expr('$JOB_CURRENT_DATE') + INTERVAL 2 YEAR) - make_dt_interval(0, 0, 0, 1)\n    ELSE EIND_DTM\nEND as date)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "cast(\nCASE\n    WHEN COALESCE(INGANG_DTM, CAST ('0001-01-01' AS DATE)) < COALESCE(DATE_TRUNC('YEAR', expr('$JOB_CURRENT_DATE') + INTERVAL -5 YEAR), CAST ('0001-01-01' AS TIMESTAMP))\n    THEN DATE_TRUNC('YEAR', expr('$JOB_CURRENT_DATE') + INTERVAL -5 YEAR)\n    ELSE INGANG_DTM\nEND as date)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_KEY",
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_KEY"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REKEN_GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "REKEN_GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ]
          },
          "componentInfo": null
        },
        "t10_3": {
          "id": "t10_3",
          "component": "Deduplicate",
          "metadata": {
            "label": "Extract_dedup",
            "slug": "Extract_dedup",
            "phase": 10,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "periode\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APU\nOriginal transform name: Extract\nOriginal output dataset names:\n- periode_pers"
          },
          "ports": {
            "inputs": [
              {
                "id": "p10_5",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p10_6",
                "slug": "Extract_periode"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "dedupType": "distinct",
            "dedupColumns": [],
            "useOrderBy": false,
            "orders": []
          },
          "componentInfo": null
        },
        "t11_1": {
          "id": "t11_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_leeftijd",
            "slug": "source_lnk_premie_rgl_leeftijd",
            "phase": 11,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p11_1",
                "slug": "LNK_PREMIE_RGL_LEEFTIJD"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_leeftijd"
          },
          "componentInfo": null
        },
        "t11_2": {
          "id": "t11_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_2",
            "slug": "Snapshot_uit_historie_2",
            "phase": 11,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APV\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_rgl_leeftijd"
          },
          "ports": {
            "inputs": [
              {
                "id": "p11_2",
                "slug": "LNK_PREMIE_RGL_LEEFTIJD"
              }
            ],
            "outputs": [
              {
                "id": "p11_3",
                "slug": "snp_LNK_PREMIE_RGL_LEEFTIJD",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_LEEFTIJD_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_LEEFTIJD_ID,COLLECTIVITEIT_OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,LEEFTIJD_VAN,LEEFTIJD_TOT_MET,LEEFTIJD_BDG,LEEFTIJD_PCT,FABRIEKSPRIJS_BDG,COMM_TOESLAG_BDG,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD",
            "history_key": "LNK_PREMIE_RGL_LEEFTIJD_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t12_1": {
          "id": "t12_1",
          "component": "SQLStatement",
          "metadata": {
            "label": "Join_1",
            "slug": "Join_1",
            "phase": 12,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Leeftijd regel\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APW\nOriginal transform name: Join\nOriginal output dataset names:\n- LFT_REGEL"
          },
          "ports": {
            "inputs": [
              {
                "id": "p12_1",
                "slug": "Extract_periode"
              },
              {
                "id": "p12_2",
                "slug": "snp_LNK_PREMIE_RGL_LEEFTIJD"
              }
            ],
            "outputs": [
              {
                "id": "p12_3",
                "slug": "join_leeftijd",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "Zorgverzekering_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_JAAR_INGANGSDATUM",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "TABELPREMIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_KEY",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "fileTabs": [
              {
                "path": "join_leeftijd",
                "id": "p12_3",
                "language": "sql",
                "content": "SELECT\n  *\n  EXCEPT (_CALC_LEEFTIJD_JAAR_INGANGSDATUM),\n  _CALC_LEEFTIJD_JAAR_INGANGSDATUM AS LEEFTIJD_JAAR_INGANGSDATUM\nFROM (\n  SELECT\n    GREATEST(PERIODE_PERS.INGANG_DTM, SNAP_RGL_LEEFTIJD.INGANG_DTM) AS INGANG_DTM,\n    LEAST(PERIODE_PERS.EIND_DTM, SNAP_RGL_LEEFTIJD.EIND_DTM) AS EIND_DTM,\n    COALESCE(PERIODE_PERS.LEEFTIJD_VAN, SNAP_RGL_LEEFTIJD.LEEFTIJD_VAN) AS LEEFTIJD_VAN,\n    COALESCE(PERIODE_PERS.LEEFTIJD_TOT_MET, SNAP_RGL_LEEFTIJD.LEEFTIJD_TOT_MET) AS LEEFTIJD_TOT_MET,\n    SNAP_RGL_LEEFTIJD.LEEFTIJD_BDG,\n    SNAP_RGL_LEEFTIJD.LEEFTIJD_PCT,\n    CASE\n      WHEN GREATEST(\n        0,\n        CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(\n          Extract_periode.REKEN_GEBOORTE_DTM,\n          GREATEST(periode_pers.INGANG_DTM, snap_rgl_leeftijd.INGANG_DTM),\n          EXPR('$SYSPEILDATUM')\n        )\n      ) <=> 30\n      AND _CALC_LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n      AND RTRIM(COALESCE(PERIODE_PERS.LABEL_KEY, '')) <=> '001'\n      THEN 29\n      ELSE GREATEST(\n        0,\n        CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(\n          Extract_periode.REKEN_GEBOORTE_DTM,\n          GREATEST(periode_pers.INGANG_DTM, snap_rgl_leeftijd.INGANG_DTM),\n          EXPR('$SYSPEILDATUM')\n        )\n      )\n    END AS INGANG_DTM_LEEFTIJD,\n    GREATEST(\n      0,\n      CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(\n        Extract_periode.REKEN_GEBOORTE_DTM,\n        LEAST(periode_pers.EIND_DTM, snap_rgl_leeftijd.EIND_DTM),\n        EXPR('$SYSPEILDATUM')\n      )\n    ) AS EIND_DTM_LEEFTIJD,\n    PERIODE_PERS.ZORGVERZEKERING_IDC,\n    PERIODE_PERS.BRN_PERSOON_ID,\n    PERIODE_PERS.GEBOORTE_DTM,\n    PERIODE_PERS.LAND_ID,\n    PERIODE_PERS.ZORGVERZ_OVEREENKOMST_ID,\n    PERIODE_PERS.BOUWSTEEN_ID,\n    PERIODE_PERS.LABEL_ID,\n    PERIODE_PERS.PRODUCTSET_SOORT_ID,\n    PERIODE_PERS.COLLECTIVITEIT_OVEREENKOMST_ID,\n    PERIODE_PERS.BETAAL_TERMIJN_ID,\n    PERIODE_PERS.EIGEN_RISICO_REGELING_ID,\n    PERIODE_PERS.REFERENTIEPREMIE_BDG,\n    PERIODE_PERS.FABRIEKSPRIJS_BDG,\n    PERIODE_PERS.COMMERCIELE_TOESLAG_BDG,\n    PERIODE_PERS.EDWH_RESOURCE_ID,\n    SNAP_RGL_LEEFTIJD.FABRIEKSPRIJS_BDG AS LFT_FABRIEKSPRIJS_BDG,\n    SNAP_RGL_LEEFTIJD.COMM_TOESLAG_BDG AS LFT_COMM_TOESLAG_BDG,\n    YEAR(GREATEST(PERIODE_PERS.INGANG_DTM, SNAP_RGL_LEEFTIJD.INGANG_DTM)) - YEAR(PERIODE_PERS.REKEN_GEBOORTE_DTM) AS _CALC_LEEFTIJD_JAAR_INGANGSDATUM,\n    PERIODE_PERS.TABELPREMIE_IDC,\n    PERIODE_PERS.LABEL_KEY,\n    PERIODE_PERS.GESLACHT_ID\n  FROM Extract_periode AS PERIODE_PERS\n  LEFT JOIN snp_LNK_PREMIE_RGL_LEEFTIJD AS SNAP_RGL_LEEFTIJD\n    ON PERIODE_PERS.COLLECTIVITEIT_OVEREENKOMST_ID <=> SNAP_RGL_LEEFTIJD.COLLECTIVITEIT_OVEREENKOMST_ID\n    AND PERIODE_PERS.PRODUCTSET_SOORT_ID <=> SNAP_RGL_LEEFTIJD.PRODUCTSET_SOORT_ID\n    AND PERIODE_PERS.BOUWSTEEN_ID <=> SNAP_RGL_LEEFTIJD.BOUWSTEEN_ID\n    AND COALESCE(PERIODE_PERS.INGANG_DTM, CAST('0001-01-01' AS DATE)) <= COALESCE(SNAP_RGL_LEEFTIJD.EIND_DTM, CAST('0001-01-01' AS DATE))\n    AND COALESCE(PERIODE_PERS.EIND_DTM, CAST('0001-01-01' AS DATE)) >= COALESCE(SNAP_RGL_LEEFTIJD.INGANG_DTM, CAST('0001-01-01' AS DATE))\n    AND NOT (\n      PERIODE_PERS.TABELPREMIE_IDC <=> 1\n    )\n)"
              }
            ],
            "inputPortNames": [
              "Extract_periode",
              "snp_LNK_PREMIE_RGL_LEEFTIJD"
            ]
          },
          "componentInfo": null
        },
        "t13_1": {
          "id": "t13_1",
          "component": "Verwijderworktabellenalleeninputs",
          "metadata": {
            "label": "Verwijder_Work_tabellen_alleen_inputs",
            "slug": "Verwijder_Work_tabellen_alleen_inputs",
            "phase": 13,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijdert alle tabellen uit die als input zijn opgenomen van deze transformatie uit de WORK en SPDE_WORK\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APX\nOriginal transform name: Verwijder Work-tabellen alleen inputs\nNo output datasets"
          },
          "ports": {
            "inputs": [
              {
                "id": "p13_1",
                "slug": "Join_premie_datum"
              },
              {
                "id": "p13_2",
                "slug": "snp_LNK_PREMIE_RGL_LEEFTIJD"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "plug": null
          },
          "componentInfo": {
            "gemId": "gems/Verwijderworktabellenalleeninputs",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t14_1": {
          "id": "t14_1",
          "component": "SQLStatement",
          "metadata": {
            "label": "Extract",
            "slug": "Extract",
            "phase": 14,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Leeftijdregel\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APY\nOriginal transform name: Extract\nOriginal output dataset names:\n- met_leeftijdregel"
          },
          "ports": {
            "inputs": [
              {
                "id": "p14_1",
                "slug": "join_leeftijd"
              }
            ],
            "outputs": [
              {
                "id": "p14_2",
                "slug": "met_leeftijdregel",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "Zorgverzekering_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_VAN_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DATUM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "TABELPREMIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "fileTabs": [
              {
                "path": "met_leeftijdregel",
                "id": "p14_2",
                "language": "sql",
                "content": "SELECT\n  *\n  EXCEPT (_CALC_LFT_INGANG_DTM, _WHERE_EXPR),\n  _CALC_LFT_INGANG_DTM AS LFT_INGANG_DTM\nFROM (\n  SELECT\n    ZORGVERZEKERING_IDC,\n    BRN_PERSOON_ID,\n    GEBOORTE_DTM,\n    LAND_ID,\n    ZORGVERZ_OVEREENKOMST_ID,\n    BOUWSTEEN_ID,\n    LABEL_ID,\n    PRODUCTSET_SOORT_ID,\n    COLLECTIVITEIT_OVEREENKOMST_ID,\n    BETAAL_TERMIJN_ID,\n    EIGEN_RISICO_REGELING_ID,\n    REFERENTIEPREMIE_BDG,\n    FABRIEKSPRIJS_BDG,\n    COMMERCIELE_TOESLAG_BDG,\n    EDWH_RESOURCE_ID,\n    CASE\n      WHEN NOT LEEFTIJD_VAN IS NULL\n      AND COALESCE(INGANG_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) < COALESCE(LEEFTIJD_VAN, CAST('-inf' AS FLOAT))\n      THEN MAKE_DATE(\n        IF(\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND (\n              NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_VAN < 100,\n          CAST((\n            IF(\n              CASE\n                WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                AND (\n                  NOT (\n                    LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                  )\n                  OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n                )\n                THEN YEAR(GEBOORTE_DTM)\n                ELSE YEAR(GEBOORTE_DTM) + 1\n              END + LEEFTIJD_VAN < 40,\n              '20',\n              '19'\n            ) || CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND (\n                NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_VAN\n          ) AS INT),\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND (\n              NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_VAN\n        ),\n        CASE\n          WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n          AND (\n            NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n          )\n          THEN MONTH(GEBOORTE_DTM) + 1\n          ELSE 1\n        END,\n        1\n      )\n      ELSE INGANG_DTM\n    END AS _CALC_LFT_INGANG_DTM,\n    LEAST(\n      EIND_DTM,\n      CASE\n        WHEN NOT LEEFTIJD_TOT_MET IS NULL\n        AND COALESCE(EIND_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) > COALESCE(LEEFTIJD_TOT_MET, CAST('-inf' AS FLOAT))\n        THEN MAKE_DATE(\n          IF(\n            CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND (\n                NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_TOT_MET + 1 < 100,\n            CAST((\n              IF(\n                CASE\n                  WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                  AND (\n                    NOT (\n                      LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                    )\n                    OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n                  )\n                  THEN YEAR(GEBOORTE_DTM)\n                  ELSE YEAR(GEBOORTE_DTM) + 1\n                END + LEEFTIJD_TOT_MET + 1 < 40,\n                '20',\n                '19'\n              ) || CASE\n                WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                AND (\n                  NOT (\n                    LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                  )\n                  OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n                )\n                THEN YEAR(GEBOORTE_DTM)\n                ELSE YEAR(GEBOORTE_DTM) + 1\n              END + LEEFTIJD_TOT_MET + 1\n            ) AS INT),\n            CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND (\n                NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_TOT_MET + 1\n          ),\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND (\n              NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              OR RTRIM(COALESCE(LABEL_KEY, '')) IN ('004', '005')\n            )\n            THEN MONTH(GEBOORTE_DTM) + 1\n            ELSE 1\n          END,\n          1\n        ) - 1\n        ELSE EIND_DTM\n      END\n    ) AS LFT_EIND_DTM,\n    LEEFTIJD_VAN,\n    LEEFTIJD_TOT_MET,\n    LEEFTIJD_BDG,\n    LEEFTIJD_PCT,\n    INGANG_DTM_LEEFTIJD AS INGANG_VAN_LEEFTIJD,\n    EIND_DTM_LEEFTIJD AS EIND_DATUM_LEEFTIJD,\n    LFT_FABRIEKSPRIJS_BDG,\n    LFT_COMM_TOESLAG_BDG,\n    TABELPREMIE_IDC,\n    GESLACHT_ID,\n    (\n      LEEFTIJD_VAN IS NULL\n      OR COALESCE(INGANG_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) <= COALESCE(LEEFTIJD_TOT_MET, CAST('-inf' AS FLOAT))\n      AND COALESCE(EIND_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) >= COALESCE(LEEFTIJD_VAN, CAST('-inf' AS FLOAT))\n      AND COALESCE(_CALC_LFT_INGANG_DTM, CAST('0001-01-01' AS DATE)) <= COALESCE(EIND_DTM, CAST('0001-01-01' AS DATE))\n    ) AS _WHERE_EXPR\n  FROM join_leeftijd\n)\nWHERE\n  _WHERE_EXPR"
              }
            ],
            "inputPortNames": [
              "join_leeftijd"
            ]
          },
          "componentInfo": null
        },
        "t15_1": {
          "id": "t15_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_brn_afwijking_premie",
            "slug": "source_lnk_brn_afwijking_premie",
            "phase": 15,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p15_1",
                "slug": "LNK_BRN_AFWIJKING_PREMIE"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_brn_afwijking_premie"
          },
          "componentInfo": null
        },
        "t15_2": {
          "id": "t15_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_3",
            "slug": "Snapshot_uit_historie_3",
            "phase": 15,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005APZ\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_AFWIJKING_PREMIE"
          },
          "ports": {
            "inputs": [
              {
                "id": "p15_2",
                "slug": "LNK_BRN_AFWIJKING_PREMIE"
              }
            ],
            "outputs": [
              {
                "id": "p15_3",
                "slug": "snap_AFWIJKING_PREMIE",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_BRN_AFWIJKING_PREMIE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "AFWIJKING_PREMIE_REDEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "HERKOMST_MUTATIE_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_BRN_AFWIJKING_PREMIE_ID,BRN_PERSOON_ID,OVEREENKOMST_ID,AFWIJKING_PREMIE_REDEN_ID,PREMIE_AFWIJKEND_BDG,PREMIE_AFWIJKEND_PCT,INGANG_DTM,EIND_DTM,HERKOMST_MUTATIE_DTD,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD",
            "history_key": "LNK_BRN_AFWIJKING_PREMIE_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t16_1": {
          "id": "t16_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_afwijking_premie_bouwst",
            "slug": "source_lnk_afwijking_premie_bouwst",
            "phase": 16,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p16_1",
                "slug": "LNK_AFWIJKING_PREMIE_BOUWST"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_afwijking_premie_bouwst"
          },
          "componentInfo": null
        },
        "t16_2": {
          "id": "t16_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_4",
            "slug": "Snapshot_uit_historie_4",
            "phase": 16,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ0\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_AFW_PREMIE_BOUWST"
          },
          "ports": {
            "inputs": [
              {
                "id": "p16_2",
                "slug": "LNK_AFWIJKING_PREMIE_BOUWST"
              }
            ],
            "outputs": [
              {
                "id": "p16_3",
                "slug": "snap_AFW_PREMIE_BOUWST",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_AFWIJKING_PREMIE_BOUWST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LNK_BRN_AFWIJKING_PREMIE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_AFWIJKING_PREMIE_BOUWST_ID,LNK_BRN_AFWIJKING_PREMIE_ID,BOUWSTEEN_ID,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD",
            "history_key": "LNK_AFWIJKING_PREMIE_BOUWST_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t17_1": {
          "id": "t17_1",
          "component": "Source",
          "metadata": {
            "label": "source_afwijking_premie_reden",
            "slug": "source_afwijking_premie_reden",
            "phase": 17,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p17_1",
                "slug": "AFWIJKING_PREMIE_REDEN"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_afwijking_premie_reden"
          },
          "componentInfo": null
        },
        "t17_2": {
          "id": "t17_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_5",
            "slug": "Snapshot_uit_historie_5",
            "phase": 17,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ1\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_afw_premie_rdn"
          },
          "ports": {
            "inputs": [
              {
                "id": "p17_2",
                "slug": "AFWIJKING_PREMIE_REDEN"
              }
            ],
            "outputs": [
              {
                "id": "p17_3",
                "slug": "snap_afw_premie_rdn",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "AFWIJKING_PREMIE_REDEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "AFWIJKING_PREMIE_REDEN_CODE",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "AFWIJKING_PREMIE_REDEN_OMS",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "AFWIJKING_PREMIE_REDEN_ID,AFWIJKING_PREMIE_REDEN_CODE,AFWIJKING_PREMIE_REDEN_OMS,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD,EDWH_RESOURCE_ID",
            "history_key": "AFWIJKING_PREMIE_REDEN_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t18_1": {
          "id": "t18_1",
          "component": "Join",
          "metadata": {
            "label": "Join_join_1",
            "slug": "Join_join_1",
            "phase": 18,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "afwijkende premie met en zonder bouwsteen\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ2\nOriginal transform name: Join\nOriginal output dataset names:\n- afw_premie"
          },
          "ports": {
            "inputs": [
              {
                "id": "p18_1",
                "slug": "snap_AFWIJKING_PREMIE"
              },
              {
                "id": "p18_2",
                "slug": "snap_AFW_PREMIE_BOUWST"
              },
              {
                "id": "p18_3",
                "slug": "snap_afw_premie_rdn"
              }
            ],
            "outputs": [
              {
                "id": "p18_4",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_AFW_PREMIE_BOUWST",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.LNK_BRN_AFWIJKING_PREMIE_ID <=> snap_AFW_PREMIE_BOUWST.LNK_BRN_AFWIJKING_PREMIE_ID"
                },
                "joinType": "left_outer"
              },
              {
                "alias": "snap_afw_premie_rdn",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.AFWIJKING_PREMIE_REDEN_ID <=> snap_afw_premie_rdn.AFWIJKING_PREMIE_REDEN_ID"
                },
                "joinType": "inner"
              }
            ],
            "expressions": [
              {
                "target": "AFWIJKING_PREMIE_REDEN_CODE",
                "expression": {
                  "format": "sql",
                  "expression": "snap_afw_premie_rdn.AFWIJKING_PREMIE_REDEN_CODE"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFW_PREMIE_BOUWST.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "CZ_SAS_BR_T_INDICATOR(snap_afw_premie_rdn.AFWIJKING_PREMIE_REDEN_CODE,'011')"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_AFWIJKING_PREMIE.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p18_1",
                "alias": "snap_AFWIJKING_PREMIE",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p18_2",
                "alias": "snap_AFW_PREMIE_BOUWST",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p18_3",
                "alias": "snap_afw_premie_rdn",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": {
              "format": "sql",
              "expression": "COALESCE(snap_AFWIJKING_PREMIE.EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(DATE_TRUNC('YEAR', expr('$SYSPEILDATUM') + INTERVAL -5 YEAR), CAST ('0001-01-01' AS TIMESTAMP))"
            },
            "headAlias": "snap_AFWIJKING_PREMIE"
          },
          "componentInfo": null
        },
        "t18_2": {
          "id": "t18_2",
          "component": "Deduplicate",
          "metadata": {
            "label": "Join_dedup",
            "slug": "Join_dedup",
            "phase": 18,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "afwijkende premie met en zonder bouwsteen\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ2\nOriginal transform name: Join\nOriginal output dataset names:\n- afw_premie"
          },
          "ports": {
            "inputs": [
              {
                "id": "p18_5",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p18_6",
                "slug": "afw_premie"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "dedupType": "distinct",
            "dedupColumns": [],
            "useOrderBy": false,
            "orders": []
          },
          "componentInfo": null
        },
        "t19_1": {
          "id": "t19_1",
          "component": "SQLStatement",
          "metadata": {
            "label": "Splitter_split_1",
            "slug": "Splitter_split_1",
            "phase": 19,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "met en zonder bouwsteen splitsen\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ3\nOriginal transform name: Splitter\nOriginal output dataset names:\n- afw_premie_zonder\n- afw_premie_bouwsteen"
          },
          "ports": {
            "inputs": [
              {
                "id": "p19_1",
                "slug": "afw_premie"
              }
            ],
            "outputs": [
              {
                "id": "p19_2",
                "slug": "afw_premie_zonder",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "AFWIJKING_PREMIE_REDEN_CODE",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "fileTabs": [
              {
                "path": "afw_premie_zonder",
                "id": "p19_2",
                "language": "sql",
                "content": "SELECT\n  BRN_PERSOON_ID,\n  OVEREENKOMST_ID,\n  PREMIE_AFWIJKEND_BDG,\n  PREMIE_AFWIJKEND_PCT,\n  INGANG_DTM,\n  EIND_DTM,\n  BOUWSTEEN_ID,\n  DETENTIE_IDC,\n  AFWIJKING_PREMIE_REDEN_CODE\nFROM afw_premie\nWHERE\n  BOUWSTEEN_ID IS NULL"
              }
            ],
            "inputPortNames": [
              "afw_premie"
            ]
          },
          "componentInfo": null
        },
        "t19_2": {
          "id": "t19_2",
          "component": "SQLStatement",
          "metadata": {
            "label": "Splitter_split_2",
            "slug": "Splitter_split_2",
            "phase": 19,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "met en zonder bouwsteen splitsen\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ3\nOriginal transform name: Splitter\nOriginal output dataset names:\n- afw_premie_zonder\n- afw_premie_bouwsteen"
          },
          "ports": {
            "inputs": [
              {
                "id": "p19_3",
                "slug": "afw_premie"
              }
            ],
            "outputs": [
              {
                "id": "p19_4",
                "slug": "afw_premie_bouwsteen",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "AFWIJKING_PREMIE_REDEN_CODE",
                      "type": "string",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "fileTabs": [
              {
                "path": "afw_premie_bouwsteen",
                "id": "p19_4",
                "language": "sql",
                "content": "SELECT\n  BRN_PERSOON_ID,\n  OVEREENKOMST_ID,\n  PREMIE_AFWIJKEND_BDG,\n  PREMIE_AFWIJKEND_PCT,\n  INGANG_DTM,\n  EIND_DTM,\n  BOUWSTEEN_ID,\n  DETENTIE_IDC,\n  AFWIJKING_PREMIE_REDEN_CODE\nFROM afw_premie\nWHERE\n  NOT BOUWSTEEN_ID IS NULL"
              }
            ],
            "inputPortNames": [
              "afw_premie"
            ]
          },
          "componentInfo": null
        },
        "t20_1": {
          "id": "t20_1",
          "component": "Join",
          "metadata": {
            "label": "Join_AFW_1",
            "slug": "Join_AFW_1",
            "phase": 20,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Afwijkende premie\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ4\nOriginal transform name: Join AFW 1\nOriginal output dataset names:\n- Met_afw_premie"
          },
          "ports": {
            "inputs": [
              {
                "id": "p20_1",
                "slug": "met_leeftijdregel"
              },
              {
                "id": "p20_2",
                "slug": "afw_premie_zonder"
              },
              {
                "id": "p20_3",
                "slug": "afw_premie_bouwsteen"
              }
            ],
            "outputs": [
              {
                "id": "p20_4",
                "slug": "Met_afw_premie"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "afw_premie_zonder",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID <=> afw_premie_zonder.BRN_PERSOON_ID AND met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID <=> afw_premie_zonder.OVEREENKOMST_ID AND COALESCE(met_leeftijdregel.LFT_INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(afw_premie_zonder.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_leeftijdregel.LFT_EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(afw_premie_zonder.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND afw_premie_zonder.BOUWSTEEN_ID IS NULL"
                },
                "joinType": "left_outer"
              },
              {
                "alias": "afw_premie_bouwsteen",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID <=> afw_premie_bouwsteen.BRN_PERSOON_ID AND met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID <=> afw_premie_bouwsteen.OVEREENKOMST_ID AND met_leeftijdregel.BOUWSTEEN_ID <=> afw_premie_bouwsteen.BOUWSTEEN_ID AND COALESCE(met_leeftijdregel.LFT_INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(afw_premie_bouwsteen.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_leeftijdregel.LFT_EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(afw_premie_bouwsteen.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND afw_premie_bouwsteen.BOUWSTEEN_ID IS NOT NULL"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "CASE\n    WHEN RTRIM(COALESCE(afw_premie_zonder.AFWIJKING_PREMIE_REDEN_CODE, afw_premie_bouwsteen.AFWIJKING_PREMIE_REDEN_CODE)) IN ('001', '011')\n    THEN 0\n    ELSE met_leeftijdregel.COMMERCIELE_TOESLAG_BDG\nEND"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "COALESCE(afw_premie_zonder.DETENTIE_IDC, afw_premie_bouwsteen.DETENTIE_IDC, 0)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(met_leeftijdregel.LFT_EIND_DTM, afw_premie_zonder.EIND_DTM, afw_premie_bouwsteen.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "CASE\n    WHEN RTRIM(COALESCE(afw_premie_zonder.AFWIJKING_PREMIE_REDEN_CODE, afw_premie_bouwsteen.AFWIJKING_PREMIE_REDEN_CODE)) IN ('001', '011')\n    THEN 0\n    ELSE met_leeftijdregel.FABRIEKSPRIJS_BDG\nEND"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(met_leeftijdregel.LFT_INGANG_DTM, afw_premie_zonder.INGANG_DTM, afw_premie_bouwsteen.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "COALESCE(afw_premie_zonder.PREMIE_AFWIJKEND_BDG, afw_premie_bouwsteen.PREMIE_AFWIJKEND_BDG)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "COALESCE(afw_premie_zonder.PREMIE_AFWIJKEND_PCT, afw_premie_bouwsteen.PREMIE_AFWIJKEND_PCT)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "1"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "CASE\n    WHEN RTRIM(COALESCE(afw_premie_zonder.AFWIJKING_PREMIE_REDEN_CODE, afw_premie_bouwsteen.AFWIJKING_PREMIE_REDEN_CODE)) IN ('001', '011')\n    THEN 0\n    ELSE met_leeftijdregel.REFERENTIEPREMIE_BDG\nEND"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p20_1",
                "alias": "met_leeftijdregel",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p20_2",
                "alias": "afw_premie_zonder",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p20_3",
                "alias": "afw_premie_bouwsteen",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "met_leeftijdregel"
          },
          "componentInfo": null
        },
        "t21_1": {
          "id": "t21_1",
          "component": "Join",
          "metadata": {
            "label": "Join_AFW_2",
            "slug": "Join_AFW_2",
            "phase": 21,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Periode voor afwijkende premie\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ5\nOriginal transform name: Join AFW 2\nOriginal output dataset names:\n- W2KHIH9F"
          },
          "ports": {
            "inputs": [
              {
                "id": "p21_1",
                "slug": "met_leeftijdregel"
              },
              {
                "id": "p21_2",
                "slug": "afw_premie_zonder"
              },
              {
                "id": "p21_3",
                "slug": "afw_premie_bouwsteen"
              }
            ],
            "outputs": [
              {
                "id": "p21_4",
                "slug": "periode_voor_ap"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "afw_premie_zonder",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID <=> afw_premie_zonder.BRN_PERSOON_ID AND met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID <=> afw_premie_zonder.OVEREENKOMST_ID AND COALESCE(met_leeftijdregel.LFT_INGANG_DTM, CAST ('0001-01-01' AS DATE)) < COALESCE(afw_premie_zonder.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_leeftijdregel.LFT_EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(afw_premie_zonder.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              },
              {
                "alias": "afw_premie_bouwsteen",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID <=> afw_premie_bouwsteen.BRN_PERSOON_ID AND met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID <=> afw_premie_bouwsteen.OVEREENKOMST_ID AND met_leeftijdregel.BOUWSTEEN_ID <=> afw_premie_bouwsteen.BOUWSTEEN_ID AND COALESCE(met_leeftijdregel.LFT_INGANG_DTM, CAST ('0001-01-01' AS DATE)) < COALESCE(afw_premie_bouwsteen.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_leeftijdregel.LFT_EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(afw_premie_bouwsteen.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "0"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(afw_premie_zonder.INGANG_DTM, afw_premie_bouwsteen.INGANG_DTM) - 1"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "CAST(NULL AS DOUBLE)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "CAST(NULL AS DOUBLE)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "2"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p21_1",
                "alias": "met_leeftijdregel",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p21_2",
                "alias": "afw_premie_zonder",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p21_3",
                "alias": "afw_premie_bouwsteen",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": {
              "format": "sql",
              "expression": "afw_premie_zonder.BRN_PERSOON_ID IS NOT NULL OR afw_premie_bouwsteen.BRN_PERSOON_ID IS NOT NULL"
            },
            "headAlias": "met_leeftijdregel"
          },
          "componentInfo": null
        },
        "t22_1": {
          "id": "t22_1",
          "component": "Join",
          "metadata": {
            "label": "Join_AFW_3",
            "slug": "Join_AFW_3",
            "phase": 22,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Periode na afwijkende premie\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ6\nOriginal transform name: Join AFW 3\nOriginal output dataset names:\n- W2KHJFPD"
          },
          "ports": {
            "inputs": [
              {
                "id": "p22_1",
                "slug": "met_leeftijdregel"
              },
              {
                "id": "p22_2",
                "slug": "afw_premie_zonder"
              },
              {
                "id": "p22_3",
                "slug": "afw_premie_bouwsteen"
              }
            ],
            "outputs": [
              {
                "id": "p22_4",
                "slug": "periode_na_ap"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "afw_premie_zonder",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID <=> afw_premie_zonder.BRN_PERSOON_ID AND met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID <=> afw_premie_zonder.OVEREENKOMST_ID AND COALESCE(met_leeftijdregel.LFT_EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(afw_premie_zonder.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_leeftijdregel.LFT_INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(afw_premie_zonder.EIND_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              },
              {
                "alias": "afw_premie_bouwsteen",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID <=> afw_premie_bouwsteen.BRN_PERSOON_ID AND met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID <=> afw_premie_bouwsteen.OVEREENKOMST_ID AND met_leeftijdregel.BOUWSTEEN_ID <=> afw_premie_bouwsteen.BOUWSTEEN_ID AND COALESCE(met_leeftijdregel.LFT_EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(afw_premie_bouwsteen.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_leeftijdregel.INGANG_VAN_LEEFTIJD, CAST ('0001-01-01' AS DATE)) <= COALESCE(afw_premie_bouwsteen.EIND_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "0"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(afw_premie_zonder.EIND_DTM, afw_premie_bouwsteen.EIND_DTM) + 1"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "CAST(NULL AS DOUBLE)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "CAST(NULL AS DOUBLE)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "2"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_leeftijdregel.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p22_1",
                "alias": "met_leeftijdregel",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p22_2",
                "alias": "afw_premie_zonder",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p22_3",
                "alias": "afw_premie_bouwsteen",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": {
              "format": "sql",
              "expression": "afw_premie_zonder.BRN_PERSOON_ID IS NOT NULL OR afw_premie_bouwsteen.BRN_PERSOON_ID IS NOT NULL"
            },
            "headAlias": "met_leeftijdregel"
          },
          "componentInfo": null
        },
        "t23_1": {
          "id": "t23_1",
          "component": "SetOperation",
          "metadata": {
            "label": "Append_union",
            "slug": "Append_union",
            "phase": 23,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Samenvoegen AFW\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ7\nOriginal transform name: Append\nOriginal output dataset names:\n- W2KR0CTL"
          },
          "ports": {
            "inputs": [
              {
                "id": "p23_1",
                "slug": "Met_afw_premie"
              },
              {
                "id": "p23_2",
                "slug": "periode_voor_ap"
              },
              {
                "id": "p23_3",
                "slug": "periode_na_ap"
              }
            ],
            "outputs": [
              {
                "id": "p23_4",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "operationType": "unionByName",
            "allowMissingColumns": true
          },
          "componentInfo": null
        },
        "t23_2": {
          "id": "t23_2",
          "component": "Reformat",
          "metadata": {
            "label": "Append_subset_cols",
            "slug": "Append_subset_cols",
            "phase": 23,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Samenvoegen AFW\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ7\nOriginal transform name: Append\nOriginal output dataset names:\n- W2KR0CTL"
          },
          "ports": {
            "inputs": [
              {
                "id": "p23_5",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p23_6",
                "slug": "Append_ap"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "PRIORITEIT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ]
          },
          "componentInfo": null
        },
        "t24_1": {
          "id": "t24_1",
          "component": "BepaalPeriodeMetPrioriteit",
          "metadata": {
            "label": "BepaalPeriodeMetPrioriteit",
            "slug": "BepaalPeriodeMetPrioriteit",
            "phase": 24,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Bepaal van een records met een periode en een prioriteit de relevante waarden, rekening houdend met de prioriteit.\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ8\nOriginal transform name: BepaalPeriodeMetPrioriteit\nOriginal output dataset names:\n- W9594ON"
          },
          "ports": {
            "inputs": [
              {
                "id": "p24_1",
                "slug": "Append_ap"
              }
            ],
            "outputs": [
              {
                "id": "p24_2",
                "slug": "BepaalPeriodeMetPrioriteit_OUTPUT0",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "Zorgverzekering_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ingang_relevante_dtm",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "eind_relevante_dtm",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "TABELPREMIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "AttribuutWaarden": "GEBOORTE_DTM,GESLACHT_ID,LAND_ID,LABEL_ID,PRODUCTSET_SOORT_ID,BETAAL_TERMIJN_ID,EIGEN_RISICO_REGELING_ID,REFERENTIEPREMIE_BDG,FABRIEKSPRIJS_BDG,COMMERCIELE_TOESLAG_BDG,EDWH_RESOURCE_ID,LEEFTIJD_VAN,LEEFTIJD_TOT_MET,LEEFTIJD_BDG,LEEFTIJD_PCT,LFT_FABRIEKSPRIJS_BDG,LFT_COMM_TOESLAG_BDG,PREMIE_AFWIJKEND_BDG,PREMIE_AFWIJKEND_PCT,DETENTIE_IDC,Zorgverzekering_IDC,TABELPREMIE_IDC",
            "EindDatum": "EIND_DTM",
            "IngangsDatum": "INGANG_DTM",
            "Prioriteit": "PRIORITEIT",
            "SleutelWaarden": "BRN_PERSOON_ID,ZORGVERZ_OVEREENKOMST_ID,BOUWSTEEN_ID,COLLECTIVITEIT_OVEREENKOMST_ID"
          },
          "componentInfo": {
            "gemId": "gems/BepaalPeriodeMetPrioriteit",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t25_1": {
          "id": "t25_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_collectiviteit",
            "slug": "source_lnk_premie_rgl_collectiviteit",
            "phase": 25,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p25_1",
                "slug": "LNK_PREMIE_RGL_COLLECTIVITEIT"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_collectiviteit"
          },
          "componentInfo": null
        },
        "t25_2": {
          "id": "t25_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_6",
            "slug": "Snapshot_uit_historie_6",
            "phase": 25,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQ9\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_rgl_collectiviteit"
          },
          "ports": {
            "inputs": [
              {
                "id": "p25_2",
                "slug": "LNK_PREMIE_RGL_COLLECTIVITEIT"
              }
            ],
            "outputs": [
              {
                "id": "p25_3",
                "slug": "snap_rgl_collectiviteit",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_COLL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_COLL_ID,COLLECTIVITEIT_OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,COLLECTIVITEIT_BDG,COLLECTIVITEIT_PCT,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_VERWIJDER_DTD,EDWH_PROCES_DTD",
            "history_key": "LNK_PREMIE_RGL_COLL_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t26_1": {
          "id": "t26_1",
          "component": "Join",
          "metadata": {
            "label": "Join_2",
            "slug": "Join_2",
            "phase": 26,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Collectiviteit\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQA\nOriginal transform name: Join\nOriginal output dataset names:\n- met_collectiviteit_rgl"
          },
          "ports": {
            "inputs": [
              {
                "id": "p26_1",
                "slug": "BepaalPeriodeMetPrioriteit_OUTPUT0"
              },
              {
                "id": "p26_2",
                "slug": "snap_rgl_collectiviteit"
              }
            ],
            "outputs": [
              {
                "id": "p26_3",
                "slug": "met_collectiviteit_rgl"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_rgl_collectiviteit",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.COLLECTIVITEIT_OVEREENKOMST_ID <=> snap_rgl_collectiviteit.COLLECTIVITEIT_OVEREENKOMST_ID AND BepaalPeriodeMetPrioriteit_OUTPUT0.PRODUCTSET_SOORT_ID <=> snap_rgl_collectiviteit.PRODUCTSET_SOORT_ID AND BepaalPeriodeMetPrioriteit_OUTPUT0.BOUWSTEEN_ID <=> snap_rgl_collectiviteit.BOUWSTEEN_ID AND COALESCE(BepaalPeriodeMetPrioriteit_OUTPUT0.INGANG_RELEVANTE_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(snap_rgl_collectiviteit.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(BepaalPeriodeMetPrioriteit_OUTPUT0.EIND_RELEVANTE_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(snap_rgl_collectiviteit.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_collectiviteit.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_collectiviteit.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(BepaalPeriodeMetPrioriteit_OUTPUT0.EIND_RELEVANTE_DTM, snap_rgl_collectiviteit.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(BepaalPeriodeMetPrioriteit_OUTPUT0.INGANG_RELEVANTE_DTM, snap_rgl_collectiviteit.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit_OUTPUT0.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p26_1",
                "alias": "BepaalPeriodeMetPrioriteit_OUTPUT0",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p26_2",
                "alias": "snap_rgl_collectiviteit",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "BepaalPeriodeMetPrioriteit_OUTPUT0"
          },
          "componentInfo": null
        },
        "t27_1": {
          "id": "t27_1",
          "component": "Verwijderworktabellenalleeninputs",
          "metadata": {
            "label": "Verwijder_Work_tabellen_alleen_inputs_1",
            "slug": "Verwijder_Work_tabellen_alleen_inputs_1",
            "phase": 27,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijdert alle tabellen uit die als input zijn opgenomen van deze transformatie uit de WORK en SPDE_WORK\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQB\nOriginal transform name: Verwijder Work-tabellen alleen inputs\nNo output datasets"
          },
          "ports": {
            "inputs": [
              {
                "id": "p27_1",
                "slug": "join_leeftijd"
              },
              {
                "id": "p27_2",
                "slug": "snap_AFWIJKING_PREMIE"
              },
              {
                "id": "p27_3",
                "slug": "snap_AFW_PREMIE_BOUWST"
              },
              {
                "id": "p27_4",
                "slug": "snap_rgl_collectiviteit"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "plug": null
          },
          "componentInfo": {
            "gemId": "gems/Verwijderworktabellenalleeninputs",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t28_1": {
          "id": "t28_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_pakketkorting",
            "slug": "source_lnk_premie_rgl_pakketkorting",
            "phase": 28,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p28_1",
                "slug": "LNK_PREMIE_RGL_PAKKETKORTING"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_pakketkorting"
          },
          "componentInfo": null
        },
        "t28_2": {
          "id": "t28_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_7",
            "slug": "Snapshot_uit_historie_7",
            "phase": 28,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQC\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_rgl_pakketkorting"
          },
          "ports": {
            "inputs": [
              {
                "id": "p28_2",
                "slug": "LNK_PREMIE_RGL_PAKKETKORTING"
              }
            ],
            "outputs": [
              {
                "id": "p28_3",
                "slug": "snap_rgl_pakketkorting",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_PAKKETKORTING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PAKKET_KORTING_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_PAKKETKORTING_ID,LABEL_ID,BRN_PERSOON_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,PAKKET_KORTING_PCT,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD",
            "history_key": "LNK_PREMIE_RGL_PAKKETKORTING_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t29_1": {
          "id": "t29_1",
          "component": "Filter",
          "metadata": {
            "label": "Extract_filter_3",
            "slug": "Extract_filter_3",
            "phase": 29,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "laatste 5 jaar\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQD\nOriginal transform name: Extract\nOriginal output dataset names:\n- W52ZP8I"
          },
          "ports": {
            "inputs": [
              {
                "id": "p29_1",
                "slug": "snap_rgl_pakketkorting"
              }
            ],
            "outputs": [
              {
                "id": "p29_2",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "condition": {
              "format": "sql",
              "expression": "COALESCE(EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(DATE_TRUNC('YEAR', expr('$SYSPEILDATUM') + INTERVAL -5 YEAR), CAST ('0001-01-01' AS TIMESTAMP))"
            }
          },
          "componentInfo": null
        },
        "t29_2": {
          "id": "t29_2",
          "component": "Reformat",
          "metadata": {
            "label": "Extract_reformat_2",
            "slug": "Extract_reformat_2",
            "phase": 29,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "laatste 5 jaar\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQD\nOriginal transform name: Extract\nOriginal output dataset names:\n- W52ZP8I"
          },
          "ports": {
            "inputs": [
              {
                "id": "p29_3",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p29_4",
                "slug": "laatst_vijf_jaar"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "expressions": [
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_PEIL_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_PEIL_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_PROCES_DTD",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_PROCES_DTD"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_VERWIJDER_DTD",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_VERWIJDER_DTD"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LNK_PREMIE_RGL_PAKKETKORTING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LNK_PREMIE_RGL_PAKKETKORTING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              }
            ]
          },
          "componentInfo": null
        },
        "t30_1": {
          "id": "t30_1",
          "component": "Join",
          "metadata": {
            "label": "Join_PKT_1",
            "slug": "Join_PKT_1",
            "phase": 30,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "pakket korting\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQE\nOriginal transform name: Join PKT 1\nOriginal output dataset names:\n- met_pakketkorting"
          },
          "ports": {
            "inputs": [
              {
                "id": "p30_1",
                "slug": "met_collectiviteit_rgl"
              },
              {
                "id": "p30_2",
                "slug": "laatst_vijf_jaar"
              }
            ],
            "outputs": [
              {
                "id": "p30_3",
                "slug": "met_pakketkorting"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "laatst_vijf_jaar",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BRN_PERSOON_ID <=> laatst_vijf_jaar.BRN_PERSOON_ID AND met_collectiviteit_rgl.LABEL_ID <=> laatst_vijf_jaar.LABEL_ID AND met_collectiviteit_rgl.BOUWSTEEN_ID <=> laatst_vijf_jaar.BOUWSTEEN_ID AND COALESCE(met_collectiviteit_rgl.INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(laatst_vijf_jaar.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_collectiviteit_rgl.EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(laatst_vijf_jaar.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(met_collectiviteit_rgl.EIND_DTM, laatst_vijf_jaar.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(met_collectiviteit_rgl.INGANG_DTM, laatst_vijf_jaar.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "laatst_vijf_jaar.PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "1"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p30_1",
                "alias": "met_collectiviteit_rgl",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p30_2",
                "alias": "laatst_vijf_jaar",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "met_collectiviteit_rgl"
          },
          "componentInfo": null
        },
        "t31_1": {
          "id": "t31_1",
          "component": "Join",
          "metadata": {
            "label": "Join_PKT_2",
            "slug": "Join_PKT_2",
            "phase": 31,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Periode voor pakketkorting\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQF\nOriginal transform name: Join PKT 2\nOriginal output dataset names:\n- W73G8AE"
          },
          "ports": {
            "inputs": [
              {
                "id": "p31_1",
                "slug": "met_collectiviteit_rgl"
              },
              {
                "id": "p31_2",
                "slug": "laatst_vijf_jaar"
              }
            ],
            "outputs": [
              {
                "id": "p31_3",
                "slug": "periode_voor_pk"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "laatst_vijf_jaar",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BRN_PERSOON_ID <=> laatst_vijf_jaar.BRN_PERSOON_ID AND met_collectiviteit_rgl.LABEL_ID <=> laatst_vijf_jaar.LABEL_ID AND met_collectiviteit_rgl.BOUWSTEEN_ID <=> laatst_vijf_jaar.BOUWSTEEN_ID AND COALESCE(met_collectiviteit_rgl.INGANG_DTM, CAST ('0001-01-01' AS DATE)) < COALESCE(laatst_vijf_jaar.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_collectiviteit_rgl.EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(laatst_vijf_jaar.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "laatst_vijf_jaar.INGANG_DTM - 1"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "CAST(NULL AS DOUBLE)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "2"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p31_1",
                "alias": "met_collectiviteit_rgl",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p31_2",
                "alias": "laatst_vijf_jaar",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": {
              "format": "sql",
              "expression": "laatst_vijf_jaar.BRN_PERSOON_ID IS NOT NULL"
            },
            "headAlias": "met_collectiviteit_rgl"
          },
          "componentInfo": null
        },
        "t32_1": {
          "id": "t32_1",
          "component": "Join",
          "metadata": {
            "label": "Join_PKT_3",
            "slug": "Join_PKT_3",
            "phase": 32,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Periode na pakketkorting\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQG\nOriginal transform name: Join PKT 3\nOriginal output dataset names:\n- W73H9Q2"
          },
          "ports": {
            "inputs": [
              {
                "id": "p32_1",
                "slug": "met_collectiviteit_rgl"
              },
              {
                "id": "p32_2",
                "slug": "laatst_vijf_jaar"
              }
            ],
            "outputs": [
              {
                "id": "p32_3",
                "slug": "periode_na_pk"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "laatst_vijf_jaar",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BRN_PERSOON_ID <=> laatst_vijf_jaar.BRN_PERSOON_ID AND met_collectiviteit_rgl.LABEL_ID <=> laatst_vijf_jaar.LABEL_ID AND met_collectiviteit_rgl.BOUWSTEEN_ID <=> laatst_vijf_jaar.BOUWSTEEN_ID AND COALESCE(met_collectiviteit_rgl.EIND_DTM, CAST ('0001-01-01' AS DATE)) > COALESCE(laatst_vijf_jaar.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_collectiviteit_rgl.INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(laatst_vijf_jaar.EIND_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "laatst_vijf_jaar.EIND_DTM + 1"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "CAST(NULL AS DOUBLE)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "2"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_collectiviteit_rgl.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p32_1",
                "alias": "met_collectiviteit_rgl",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p32_2",
                "alias": "laatst_vijf_jaar",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": {
              "format": "sql",
              "expression": "laatst_vijf_jaar.BRN_PERSOON_ID IS NOT NULL"
            },
            "headAlias": "met_collectiviteit_rgl"
          },
          "componentInfo": null
        },
        "t33_1": {
          "id": "t33_1",
          "component": "SetOperation",
          "metadata": {
            "label": "Append_union_1",
            "slug": "Append_union_1",
            "phase": 33,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Samenvoegen PKT\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQH\nOriginal transform name: Append\nOriginal output dataset names:\n- W73K9U4"
          },
          "ports": {
            "inputs": [
              {
                "id": "p33_1",
                "slug": "met_pakketkorting"
              },
              {
                "id": "p33_2",
                "slug": "periode_voor_pk"
              },
              {
                "id": "p33_3",
                "slug": "periode_na_pk"
              }
            ],
            "outputs": [
              {
                "id": "p33_4",
                "slug": "out0"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "operationType": "unionByName",
            "allowMissingColumns": true
          },
          "componentInfo": null
        },
        "t33_2": {
          "id": "t33_2",
          "component": "Reformat",
          "metadata": {
            "label": "Append_subset_cols_1",
            "slug": "Append_subset_cols_1",
            "phase": 33,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Samenvoegen PKT\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQH\nOriginal transform name: Append\nOriginal output dataset names:\n- W73K9U4"
          },
          "ports": {
            "inputs": [
              {
                "id": "p33_5",
                "slug": "in0"
              }
            ],
            "outputs": [
              {
                "id": "p33_6",
                "slug": "Append_pk"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "columnsSelector": [],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "EIND_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "INGANG_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRIORITEIT",
                "expression": {
                  "format": "sql",
                  "expression": "PRIORITEIT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "TABELPREMIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "TABELPREMIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ]
          },
          "componentInfo": null
        },
        "t34_1": {
          "id": "t34_1",
          "component": "BepaalPeriodeMetPrioriteit",
          "metadata": {
            "label": "BepaalPeriodeMetPrioriteit_1",
            "slug": "BepaalPeriodeMetPrioriteit_1",
            "phase": 34,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Bepaal van een records met een periode en een prioriteit de relevante waarden, rekening houdend met de prioriteit.\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQI\nOriginal transform name: BepaalPeriodeMetPrioriteit\nOriginal output dataset names:\n- W973D84"
          },
          "ports": {
            "inputs": [
              {
                "id": "p34_1",
                "slug": "Append_pk"
              }
            ],
            "outputs": [
              {
                "id": "p34_2",
                "slug": "BepaalPeriodeMetPrioriteit",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "Zorgverzekering_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ingang_relevante_dtm",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "eind_relevante_dtm",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PAKKET_KORTING_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRIORITEIT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "TABELPREMIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "AttribuutWaarden": "Zorgverzekering_IDC,GEBOORTE_DTM,GESLACHT_ID,LAND_ID,PRODUCTSET_SOORT_ID,BETAAL_TERMIJN_ID,EIGEN_RISICO_REGELING_ID,REFERENTIEPREMIE_BDG,FABRIEKSPRIJS_BDG,COMMERCIELE_TOESLAG_BDG,EDWH_RESOURCE_ID,LEEFTIJD_VAN,LEEFTIJD_TOT_MET,LEEFTIJD_BDG,LEEFTIJD_PCT,LFT_FABRIEKSPRIJS_BDG,LFT_COMM_TOESLAG_BDG,PREMIE_AFWIJKEND_BDG,PREMIE_AFWIJKEND_PCT,COLLECTIVITEIT_BDG,COLLECTIVITEIT_PCT,PAKKET_KORTING_PCT,DETENTIE_IDC,TABELPREMIE_IDC",
            "EindDatum": "EIND_DTM",
            "IngangsDatum": "INGANG_DTM",
            "Prioriteit": "PRIORITEIT",
            "SleutelWaarden": "BRN_PERSOON_ID,ZORGVERZ_OVEREENKOMST_ID,BOUWSTEEN_ID,LABEL_ID,COLLECTIVITEIT_OVEREENKOMST_ID"
          },
          "componentInfo": {
            "gemId": "gems/BepaalPeriodeMetPrioriteit",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t35_1": {
          "id": "t35_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_eigen_risico",
            "slug": "source_lnk_premie_rgl_eigen_risico",
            "phase": 35,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p35_1",
                "slug": "LNK_PREMIE_RGL_EIGEN_RISICO"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_eigen_risico"
          },
          "componentInfo": null
        },
        "t35_2": {
          "id": "t35_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_8",
            "slug": "Snapshot_uit_historie_8",
            "phase": 35,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQJ\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_rgl_eigenrisico"
          },
          "ports": {
            "inputs": [
              {
                "id": "p35_2",
                "slug": "LNK_PREMIE_RGL_EIGEN_RISICO"
              }
            ],
            "outputs": [
              {
                "id": "p35_3",
                "slug": "snap_rgl_eigenrisico",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_EIGEN_RISICO_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_EIGEN_RISICO_ID,COLLECTIVITEIT_OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,EIGEN_RISICO_REGELING_ID,LEEFTIJD_VAN,LEEFTIJD_TOT_MET,INGANG_DTM,EIND_DTM,EIGEN_RISICO_BDG,EIGEN_RISICO_PCT,FABRIEKSPRIJS_BDG,COMM_TOESLAG_BDG,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_PROCES_DTD,EDWH_VERWIJDER_DTD",
            "history_key": "LNK_PREMIE_RGL_EIGEN_RISICO_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t36_1": {
          "id": "t36_1",
          "component": "Join",
          "metadata": {
            "label": "Join_3",
            "slug": "Join_3",
            "phase": 36,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "eigen risico\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQK\nOriginal transform name: Join\nOriginal output dataset names:\n- ER_REGEL"
          },
          "ports": {
            "inputs": [
              {
                "id": "p36_1",
                "slug": "BepaalPeriodeMetPrioriteit"
              },
              {
                "id": "p36_2",
                "slug": "snap_rgl_eigenrisico"
              }
            ],
            "outputs": [
              {
                "id": "p36_3",
                "slug": "ER_REGEL"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_rgl_eigenrisico",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.COLLECTIVITEIT_OVEREENKOMST_ID <=> snap_rgl_eigenrisico.COLLECTIVITEIT_OVEREENKOMST_ID AND BepaalPeriodeMetPrioriteit.PRODUCTSET_SOORT_ID <=> snap_rgl_eigenrisico.PRODUCTSET_SOORT_ID AND BepaalPeriodeMetPrioriteit.BOUWSTEEN_ID <=> snap_rgl_eigenrisico.BOUWSTEEN_ID AND BepaalPeriodeMetPrioriteit.EIGEN_RISICO_REGELING_ID <=> snap_rgl_eigenrisico.EIGEN_RISICO_REGELING_ID AND COALESCE(BepaalPeriodeMetPrioriteit.INGANG_RELEVANTE_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(snap_rgl_eigenrisico.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(BepaalPeriodeMetPrioriteit.EIND_RELEVANTE_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(snap_rgl_eigenrisico.INGANG_DTM, CAST ('0001-01-01' AS DATE)) AND NOT (BepaalPeriodeMetPrioriteit.TABELPREMIE_IDC <=> 1)"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_eigenrisico.EIGEN_RISICO_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_eigenrisico.EIGEN_RISICO_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(BepaalPeriodeMetPrioriteit.EIND_RELEVANTE_DTM, snap_rgl_eigenrisico.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM_LEEFTIJD",
                "expression": {
                  "format": "sql",
                  "expression": "CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(BepaalPeriodeMetPrioriteit.GEBOORTE_DTM,min( W973D84.eind_relevante_dtm , snap_rgl_eigenrisico.EIND_DTM),expr('$SYSPEILDATUM'))"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_eigenrisico.COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_eigenrisico.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(BepaalPeriodeMetPrioriteit.INGANG_RELEVANTE_DTM, snap_rgl_eigenrisico.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM_LEEFTIJD",
                "expression": {
                  "format": "sql",
                  "expression": "CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(BepaalPeriodeMetPrioriteit.GEBOORTE_DTM,max( W973D84.ingang_relevante_dtm , snap_rgl_eigenrisico.INGANG_DTM),expr('$SYSPEILDATUM'))"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_JAAR_INGANGSDATUM",
                "expression": {
                  "format": "sql",
                  "expression": "YEAR(GREATEST(BepaalPeriodeMetPrioriteit.INGANG_RELEVANTE_DTM, snap_rgl_eigenrisico.INGANG_DTM)) - YEAR(BepaalPeriodeMetPrioriteit.GEBOORTE_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_ER",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_eigenrisico.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_ER",
                "expression": {
                  "format": "sql",
                  "expression": "snap_rgl_eigenrisico.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "BepaalPeriodeMetPrioriteit.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p36_1",
                "alias": "BepaalPeriodeMetPrioriteit",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p36_2",
                "alias": "snap_rgl_eigenrisico",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "BepaalPeriodeMetPrioriteit"
          },
          "componentInfo": null
        },
        "t37_1": {
          "id": "t37_1",
          "component": "Verwijderworktabellenalleeninputs",
          "metadata": {
            "label": "Verwijder_Work_tabellen_alleen_inputs_2",
            "slug": "Verwijder_Work_tabellen_alleen_inputs_2",
            "phase": 37,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijdert alle tabellen uit die als input zijn opgenomen van deze transformatie uit de WORK en SPDE_WORK\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQL\nOriginal transform name: Verwijder Work-tabellen alleen inputs\nNo output datasets"
          },
          "ports": {
            "inputs": [
              {
                "id": "p37_1",
                "slug": "Append_ap"
              },
              {
                "id": "p37_2",
                "slug": "BepaalPeriodeMetPrioriteit_OUTPUT0"
              },
              {
                "id": "p37_3",
                "slug": "met_collectiviteit_rgl"
              },
              {
                "id": "p37_4",
                "slug": "snap_rgl_pakketkorting"
              },
              {
                "id": "p37_5",
                "slug": "Append_pk"
              },
              {
                "id": "p37_6",
                "slug": "snap_rgl_eigenrisico"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "plug": null
          },
          "componentInfo": {
            "gemId": "gems/Verwijderworktabellenalleeninputs",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t38_1": {
          "id": "t38_1",
          "component": "SQLStatement",
          "metadata": {
            "label": "Extract_1",
            "slug": "Extract_1",
            "phase": 38,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "eigen risico\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQM\nOriginal transform name: Extract\nOriginal output dataset names:\n- met_ER_regel"
          },
          "ports": {
            "inputs": [
              {
                "id": "p38_1",
                "slug": "ER_REGEL"
              }
            ],
            "outputs": [
              {
                "id": "p38_2",
                "slug": "met_ER_regel",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "Zorgverzekering_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PAKKET_KORTING_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN_ER",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET_ER",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "fileTabs": [
              {
                "path": "met_ER_regel",
                "id": "p38_2",
                "language": "sql",
                "content": "SELECT\n  *\n  EXCEPT (_CALC_ER_INGANG_DTM, _WHERE_EXPR),\n  _CALC_ER_INGANG_DTM AS ER_INGANG_DTM\nFROM (\n  SELECT\n    ZORGVERZEKERING_IDC,\n    BRN_PERSOON_ID,\n    GEBOORTE_DTM,\n    LAND_ID,\n    ZORGVERZ_OVEREENKOMST_ID,\n    BOUWSTEEN_ID,\n    LABEL_ID,\n    PRODUCTSET_SOORT_ID,\n    COLLECTIVITEIT_OVEREENKOMST_ID,\n    BETAAL_TERMIJN_ID,\n    EIGEN_RISICO_REGELING_ID,\n    REFERENTIEPREMIE_BDG,\n    FABRIEKSPRIJS_BDG,\n    COMMERCIELE_TOESLAG_BDG,\n    EDWH_RESOURCE_ID,\n    CASE\n      WHEN NOT LEEFTIJD_VAN_ER IS NULL\n      AND COALESCE(LEEFTIJD_VAN_ER, CAST('-inf' AS FLOAT)) > COALESCE(INGANG_DTM_LEEFTIJD, CAST('-inf' AS FLOAT))\n      THEN MAKE_DATE(\n        IF(\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_VAN_ER < 100,\n          CAST((\n            IF(\n              CASE\n                WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                AND NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                THEN YEAR(GEBOORTE_DTM)\n                ELSE YEAR(GEBOORTE_DTM) + 1\n              END + LEEFTIJD_VAN_ER < 40,\n              '20',\n              '19'\n            ) || CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_VAN_ER\n          ) AS INT),\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_VAN_ER\n        ),\n        CASE\n          WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n          AND NOT (\n            LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n          )\n          THEN MONTH(GEBOORTE_DTM) + 1\n          ELSE 1\n        END,\n        1\n      )\n      ELSE INGANG_DTM\n    END AS _CALC_ER_INGANG_DTM,\n    CASE\n      WHEN NOT LEEFTIJD_TOT_MET_ER IS NULL\n      AND COALESCE(LEEFTIJD_TOT_MET_ER, CAST('-inf' AS FLOAT)) < COALESCE(EIND_DTM_LEEFTIJD, CAST('-inf' AS FLOAT))\n      THEN MAKE_DATE(\n        IF(\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_TOT_MET_ER + 1 < 100,\n          CAST((\n            IF(\n              CASE\n                WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                AND NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                THEN YEAR(GEBOORTE_DTM)\n                ELSE YEAR(GEBOORTE_DTM) + 1\n              END + LEEFTIJD_TOT_MET_ER + 1 < 40,\n              '20',\n              '19'\n            ) || CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_TOT_MET_ER + 1\n          ) AS INT),\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_TOT_MET_ER + 1\n        ),\n        CASE\n          WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n          AND NOT (\n            LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n          )\n          THEN MONTH(GEBOORTE_DTM) + 1\n          ELSE 1\n        END,\n        1\n      ) - 1\n      ELSE EIND_DTM\n    END AS ER_EIND_DTM,\n    LEEFTIJD_VAN,\n    LEEFTIJD_TOT_MET,\n    LEEFTIJD_BDG,\n    LFT_FABRIEKSPRIJS_BDG,\n    LFT_COMM_TOESLAG_BDG,\n    PREMIE_AFWIJKEND_BDG,\n    LEEFTIJD_PCT,\n    PREMIE_AFWIJKEND_PCT,\n    COLLECTIVITEIT_BDG,\n    COLLECTIVITEIT_PCT,\n    PAKKET_KORTING_PCT,\n    LEEFTIJD_VAN_ER,\n    LEEFTIJD_TOT_MET_ER,\n    EIGEN_RISICO_BDG,\n    ER_FABRIEKSPRIJS_BDG,\n    ER_COMM_TOESLAG_BDG,\n    EIGEN_RISICO_PCT,\n    INGANG_DTM_LEEFTIJD,\n    EIND_DTM_LEEFTIJD,\n    DETENTIE_IDC,\n    GESLACHT_ID,\n    (\n      LEEFTIJD_VAN_ER IS NULL\n      OR COALESCE(INGANG_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) <= COALESCE(LEEFTIJD_TOT_MET_ER, CAST('-inf' AS FLOAT))\n      AND COALESCE(EIND_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) >= COALESCE(LEEFTIJD_VAN_ER, CAST('-inf' AS FLOAT))\n      AND COALESCE(_CALC_ER_INGANG_DTM, CAST('0001-01-01' AS DATE)) <= COALESCE(EIND_DTM, CAST('0001-01-01' AS DATE))\n    ) AS _WHERE_EXPR\n  FROM ER_REGEL\n)\nWHERE\n  _WHERE_EXPR"
              }
            ],
            "inputPortNames": [
              "ER_REGEL"
            ]
          },
          "componentInfo": null
        },
        "t39_1": {
          "id": "t39_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_assurantie",
            "slug": "source_lnk_premie_rgl_assurantie",
            "phase": 39,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p39_1",
                "slug": "LNK_PREMIE_RGL_ASSURANTIE"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_assurantie"
          },
          "componentInfo": null
        },
        "t39_2": {
          "id": "t39_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_9",
            "slug": "Snapshot_uit_historie_9",
            "phase": 39,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQN\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_ass"
          },
          "ports": {
            "inputs": [
              {
                "id": "p39_2",
                "slug": "LNK_PREMIE_RGL_ASSURANTIE"
              }
            ],
            "outputs": [
              {
                "id": "p39_3",
                "slug": "snap_ass",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_ASSURANTIE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ASSURANTIE_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_ASSURANTIE_ID,LABEL_ID,BOUWSTEEN_ID,LAND_ID,INGANG_DTM,EIND_DTM,ASSURANTIE_PCT,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_VERWIJDER_DTD,EDWH_PROCES_DTD",
            "history_key": "LNK_PREMIE_RGL_ASSURANTIE_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t40_1": {
          "id": "t40_1",
          "component": "Join",
          "metadata": {
            "label": "Join_4",
            "slug": "Join_4",
            "phase": 40,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "assurantie (betax)\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQO\nOriginal transform name: Join\nOriginal output dataset names:\n- met_ass"
          },
          "ports": {
            "inputs": [
              {
                "id": "p40_1",
                "slug": "met_ER_regel"
              },
              {
                "id": "p40_2",
                "slug": "snap_ass"
              }
            ],
            "outputs": [
              {
                "id": "p40_3",
                "slug": "met_ass"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_ass",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LABEL_ID <=> snap_ass.LABEL_ID AND met_ER_regel.BOUWSTEEN_ID <=> snap_ass.BOUWSTEEN_ID AND met_ER_regel.LAND_ID <=> snap_ass.LAND_ID AND COALESCE(met_ER_regel.ER_INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(snap_ass.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_ER_regel.ER_EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(snap_ass.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "ASSURANTIE_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_ass.ASSURANTIE_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.EIGEN_RISICO_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.EIGEN_RISICO_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(met_ER_regel.ER_EIND_DTM, snap_ass.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.ER_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.ER_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(met_ER_regel.ER_INGANG_DTM, snap_ass.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LEEFTIJD_TOT_MET_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LEEFTIJD_VAN_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ER_regel.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p40_1",
                "alias": "met_ER_regel",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p40_2",
                "alias": "snap_ass",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "met_ER_regel"
          },
          "componentInfo": null
        },
        "t41_1": {
          "id": "t41_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_buitenland",
            "slug": "source_lnk_premie_rgl_buitenland",
            "phase": 41,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p41_1",
                "slug": "LNK_PREMIE_RGL_BUITENLAND"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_buitenland"
          },
          "componentInfo": null
        },
        "t41_2": {
          "id": "t41_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_10",
            "slug": "Snapshot_uit_historie_10",
            "phase": 41,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQP\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_bl"
          },
          "ports": {
            "inputs": [
              {
                "id": "p41_2",
                "slug": "LNK_PREMIE_RGL_BUITENLAND"
              }
            ],
            "outputs": [
              {
                "id": "p41_3",
                "slug": "snap_bl",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_BUITENLAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BUITENLAND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSDEEL",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIEEL_DEEL",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BUITENLAND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_BUITENLAND_ID,COLLECTIVITEIT_OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,LAND_ID,LEEFTIJD_VAN,LEEFTIJD_TOT_MET,BUITENLAND_BDG,FABRIEKSDEEL,COMMERCIEEL_DEEL,BUITENLAND_PCT,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_VERWIJDER_DTD,EDWH_PROCES_DTD",
            "history_key": "LNK_PREMIE_RGL_BUITENLAND_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t42_1": {
          "id": "t42_1",
          "component": "Join",
          "metadata": {
            "label": "Join_5",
            "slug": "Join_5",
            "phase": 42,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "buitenland\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQQ\nOriginal transform name: Join\nOriginal output dataset names:\n- BL_RGL"
          },
          "ports": {
            "inputs": [
              {
                "id": "p42_1",
                "slug": "met_ass"
              },
              {
                "id": "p42_2",
                "slug": "snap_bl"
              }
            ],
            "outputs": [
              {
                "id": "p42_3",
                "slug": "BL_RGL"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_bl",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.COLLECTIVITEIT_OVEREENKOMST_ID <=> snap_bl.COLLECTIVITEIT_OVEREENKOMST_ID AND met_ass.PRODUCTSET_SOORT_ID <=> snap_bl.PRODUCTSET_SOORT_ID AND met_ass.BOUWSTEEN_ID <=> snap_bl.BOUWSTEEN_ID AND met_ass.LAND_ID <=> snap_bl.LAND_ID AND COALESCE(met_ass.INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(snap_bl.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_ass.EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(snap_bl.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "ASSURANTIE_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.ASSURANTIE_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BUITENLAND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_bl.BUITENLAND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BUITENLAND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_bl.BUITENLAND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.EIGEN_RISICO_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.EIGEN_RISICO_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(met_ass.EIND_DTM, snap_bl.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM_LEEFTIJD",
                "expression": {
                  "format": "sql",
                  "expression": "CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(met_ass.GEBOORTE_DTM,min( met_ass.EIND_DTM , snap_bl.EIND_DTM),expr('$SYSPEILDATUM'))"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.ER_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.ER_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(met_ass.INGANG_DTM, snap_bl.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM_LEEFTIJD",
                "expression": {
                  "format": "sql",
                  "expression": "CZ_SAS_BR_T_NATUURLIJK_PERS_LEEFTIJD(met_ass.GEBOORTE_DTM,max( met_ass.INGANG_DTM , snap_bl.INGANG_DTM),expr('$SYSPEILDATUM'))"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_JAAR_INGANGSDATUM",
                "expression": {
                  "format": "sql",
                  "expression": "YEAR(GREATEST(met_ass.INGANG_DTM, snap_bl.INGANG_DTM)) - YEAR(met_ass.GEBOORTE_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_BL",
                "expression": {
                  "format": "sql",
                  "expression": "snap_bl.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LEEFTIJD_TOT_MET_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_BL",
                "expression": {
                  "format": "sql",
                  "expression": "snap_bl.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LEEFTIJD_VAN_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_ass.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p42_1",
                "alias": "met_ass",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p42_2",
                "alias": "snap_bl",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "met_ass"
          },
          "componentInfo": null
        },
        "t43_1": {
          "id": "t43_1",
          "component": "Verwijderworktabellenalleeninputs",
          "metadata": {
            "label": "Verwijder_Work_tabellen_alleen_inputs_3",
            "slug": "Verwijder_Work_tabellen_alleen_inputs_3",
            "phase": 43,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijdert alle tabellen uit die als input zijn opgenomen van deze transformatie uit de WORK en SPDE_WORK\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQR\nOriginal transform name: Verwijder Work-tabellen alleen inputs\nNo output datasets"
          },
          "ports": {
            "inputs": [
              {
                "id": "p43_1",
                "slug": "BepaalPeriodeMetPrioriteit"
              },
              {
                "id": "p43_2",
                "slug": "ER_REGEL"
              },
              {
                "id": "p43_3",
                "slug": "snap_ass"
              },
              {
                "id": "p43_4",
                "slug": "snap_bl"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "plug": null
          },
          "componentInfo": {
            "gemId": "gems/Verwijderworktabellenalleeninputs",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t44_1": {
          "id": "t44_1",
          "component": "SQLStatement",
          "metadata": {
            "label": "Extract_2",
            "slug": "Extract_2",
            "phase": 44,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "buitenland\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQS\nOriginal transform name: Extract\nOriginal output dataset names:\n- met_buitenland"
          },
          "ports": {
            "inputs": [
              {
                "id": "p44_1",
                "slug": "BL_RGL"
              }
            ],
            "outputs": [
              {
                "id": "p44_2",
                "slug": "met_buitenland",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "Zorgverzekering_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BL_INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BL_EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PAKKET_KORTING_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN_ER",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET_ER",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ASSURANTIE_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN_BL",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET_BL",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BUITENLAND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BUITENLAND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM_LEEFTIJD",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "fileTabs": [
              {
                "path": "met_buitenland",
                "id": "p44_2",
                "language": "sql",
                "content": "SELECT\n  *\n  EXCEPT (_CALC_BL_INGANG_DTM, _WHERE_EXPR),\n  _CALC_BL_INGANG_DTM AS BL_INGANG_DTM\nFROM (\n  SELECT\n    ZORGVERZEKERING_IDC,\n    BRN_PERSOON_ID,\n    GEBOORTE_DTM,\n    LAND_ID,\n    ZORGVERZ_OVEREENKOMST_ID,\n    BOUWSTEEN_ID,\n    LABEL_ID,\n    PRODUCTSET_SOORT_ID,\n    COLLECTIVITEIT_OVEREENKOMST_ID,\n    BETAAL_TERMIJN_ID,\n    EIGEN_RISICO_REGELING_ID,\n    REFERENTIEPREMIE_BDG,\n    FABRIEKSPRIJS_BDG,\n    COMMERCIELE_TOESLAG_BDG,\n    EDWH_RESOURCE_ID,\n    CASE\n      WHEN NOT LEEFTIJD_VAN_BL IS NULL\n      AND COALESCE(LEEFTIJD_VAN_BL, CAST('-inf' AS FLOAT)) > COALESCE(INGANG_DTM_LEEFTIJD, CAST('-inf' AS FLOAT))\n      THEN MAKE_DATE(\n        IF(\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_VAN_BL < 100,\n          CAST((\n            IF(\n              CASE\n                WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                AND NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                THEN YEAR(GEBOORTE_DTM)\n                ELSE YEAR(GEBOORTE_DTM) + 1\n              END + LEEFTIJD_VAN_BL < 40,\n              '20',\n              '19'\n            ) || CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_VAN_BL\n          ) AS INT),\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_VAN_BL\n        ),\n        CASE\n          WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n          AND NOT (\n            LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n          )\n          THEN MONTH(GEBOORTE_DTM) + 1\n          ELSE 1\n        END,\n        1\n      )\n      ELSE INGANG_DTM\n    END AS _CALC_BL_INGANG_DTM,\n    CASE\n      WHEN NOT LEEFTIJD_TOT_MET_BL IS NULL\n      AND COALESCE(LEEFTIJD_TOT_MET_BL, CAST('-inf' AS FLOAT)) < COALESCE(EIND_DTM_LEEFTIJD, CAST('-inf' AS FLOAT))\n      THEN MAKE_DATE(\n        IF(\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_TOT_MET_BL + 1 < 100,\n          CAST((\n            IF(\n              CASE\n                WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n                AND NOT (\n                  LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n                )\n                THEN YEAR(GEBOORTE_DTM)\n                ELSE YEAR(GEBOORTE_DTM) + 1\n              END + LEEFTIJD_TOT_MET_BL + 1 < 40,\n              '20',\n              '19'\n            ) || CASE\n              WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n              AND NOT (\n                LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n              )\n              THEN YEAR(GEBOORTE_DTM)\n              ELSE YEAR(GEBOORTE_DTM) + 1\n            END + LEEFTIJD_TOT_MET_BL + 1\n          ) AS INT),\n          CASE\n            WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n            AND NOT (\n              LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n            )\n            THEN YEAR(GEBOORTE_DTM)\n            ELSE YEAR(GEBOORTE_DTM) + 1\n          END + LEEFTIJD_TOT_MET_BL + 1\n        ),\n        CASE\n          WHEN COALESCE(MONTH(GEBOORTE_DTM), CAST('-inf' AS FLOAT)) < 12\n          AND NOT (\n            LEEFTIJD_JAAR_INGANGSDATUM <=> 30\n          )\n          THEN MONTH(GEBOORTE_DTM) + 1\n          ELSE 1\n        END,\n        1\n      ) - 1\n      ELSE EIND_DTM\n    END AS BL_EIND_DTM,\n    LEEFTIJD_VAN,\n    LEEFTIJD_TOT_MET,\n    LEEFTIJD_BDG,\n    LFT_FABRIEKSPRIJS_BDG,\n    LFT_COMM_TOESLAG_BDG,\n    PREMIE_AFWIJKEND_BDG,\n    LEEFTIJD_PCT,\n    PREMIE_AFWIJKEND_PCT,\n    COLLECTIVITEIT_BDG,\n    COLLECTIVITEIT_PCT,\n    PAKKET_KORTING_PCT,\n    LEEFTIJD_VAN_ER,\n    LEEFTIJD_TOT_MET_ER,\n    EIGEN_RISICO_BDG,\n    ER_FABRIEKSPRIJS_BDG,\n    ER_COMM_TOESLAG_BDG,\n    EIGEN_RISICO_PCT,\n    ASSURANTIE_PCT,\n    LEEFTIJD_VAN_BL,\n    LEEFTIJD_TOT_MET_BL,\n    BUITENLAND_BDG,\n    BUITENLAND_PCT,\n    INGANG_DTM_LEEFTIJD,\n    EIND_DTM_LEEFTIJD,\n    DETENTIE_IDC,\n    GESLACHT_ID,\n    (\n      LEEFTIJD_VAN_BL IS NULL\n      OR COALESCE(INGANG_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) <= COALESCE(LEEFTIJD_TOT_MET_BL, CAST('-inf' AS FLOAT))\n      AND COALESCE(EIND_DTM_LEEFTIJD, CAST('-inf' AS FLOAT)) >= COALESCE(LEEFTIJD_VAN_BL, CAST('-inf' AS FLOAT))\n      AND COALESCE(_CALC_BL_INGANG_DTM, CAST('0001-01-01' AS DATE)) <= COALESCE(EIND_DTM, CAST('0001-01-01' AS DATE))\n    ) AS _WHERE_EXPR\n  FROM BL_RGL\n)\nWHERE\n  _WHERE_EXPR"
              }
            ],
            "inputPortNames": [
              "BL_RGL"
            ]
          },
          "componentInfo": null
        },
        "t45_1": {
          "id": "t45_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_eigen_product",
            "slug": "source_lnk_premie_rgl_eigen_product",
            "phase": 45,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p45_1",
                "slug": "LNK_PREMIE_RGL_EIGEN_PRODUCT"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_eigen_product"
          },
          "componentInfo": null
        },
        "t45_2": {
          "id": "t45_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_11",
            "slug": "Snapshot_uit_historie_11",
            "phase": 45,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQT\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_eigenprod"
          },
          "ports": {
            "inputs": [
              {
                "id": "p45_2",
                "slug": "LNK_PREMIE_RGL_EIGEN_PRODUCT"
              }
            ],
            "outputs": [
              {
                "id": "p45_3",
                "slug": "snap_eigenprod",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_EIGEN_PRD_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_PRODUCT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_PRODUCT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_EIGEN_PRD_ID,COLLECTIVITEIT_OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,EIGEN_PRODUCT_PCT,EIGEN_PRODUCT_BDG,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_VERWIJDER_DTD,EDWH_PROCES_DTD",
            "history_key": "LNK_PREMIE_RGL_EIGEN_PRD_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t46_1": {
          "id": "t46_1",
          "component": "Join",
          "metadata": {
            "label": "Join_6",
            "slug": "Join_6",
            "phase": 46,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "eigen product\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQU\nOriginal transform name: Join\nOriginal output dataset names:\n- met_eigen_prod"
          },
          "ports": {
            "inputs": [
              {
                "id": "p46_1",
                "slug": "met_buitenland"
              },
              {
                "id": "p46_2",
                "slug": "snap_eigenprod"
              }
            ],
            "outputs": [
              {
                "id": "p46_3",
                "slug": "met_eigen_prod"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_eigenprod",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.COLLECTIVITEIT_OVEREENKOMST_ID <=> snap_eigenprod.COLLECTIVITEIT_OVEREENKOMST_ID AND met_buitenland.PRODUCTSET_SOORT_ID <=> snap_eigenprod.PRODUCTSET_SOORT_ID AND met_buitenland.BOUWSTEEN_ID <=> snap_eigenprod.BOUWSTEEN_ID AND COALESCE(met_buitenland.BL_INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(snap_eigenprod.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_buitenland.BL_EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(snap_eigenprod.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "ASSURANTIE_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.ASSURANTIE_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BUITENLAND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.BUITENLAND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BUITENLAND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.BUITENLAND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_PRODUCT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "snap_eigenprod.EIGEN_PRODUCT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_PRODUCT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_eigenprod.EIGEN_PRODUCT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.EIGEN_RISICO_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.EIGEN_RISICO_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(met_buitenland.BL_EIND_DTM, snap_eigenprod.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.ER_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.ER_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(met_buitenland.BL_INGANG_DTM, snap_eigenprod.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_BL",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_TOT_MET_BL"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_TOT_MET_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_BL",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_VAN_BL"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LEEFTIJD_VAN_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_buitenland.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p46_1",
                "alias": "met_buitenland",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p46_2",
                "alias": "snap_eigenprod",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "met_buitenland"
          },
          "componentInfo": null
        },
        "t47_1": {
          "id": "t47_1",
          "component": "Source",
          "metadata": {
            "label": "source_lnk_premie_rgl_betaaltermijn",
            "slug": "source_lnk_premie_rgl_betaaltermijn",
            "phase": 47,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p47_1",
                "slug": "LNK_PREMIE_RGL_BETAALTERMIJN"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_edwh_lnk_premie_rgl_betaaltermijn"
          },
          "componentInfo": null
        },
        "t47_2": {
          "id": "t47_2",
          "component": "SnapshotFromHistory",
          "metadata": {
            "label": "Snapshot_uit_historie_12",
            "slug": "Snapshot_uit_historie_12",
            "phase": 47,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijderde regels behouden: No\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQV\nOriginal transform name: Snapshot uit historie\nOriginal output dataset names:\n- snap_bet_term"
          },
          "ports": {
            "inputs": [
              {
                "id": "p47_2",
                "slug": "LNK_PREMIE_RGL_BETAALTERMIJN"
              }
            ],
            "outputs": [
              {
                "id": "p47_3",
                "slug": "snap_bet_term",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "LNK_PREMIE_RGL_BETAAL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAALTERMIJN_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PEIL_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_VERWIJDER_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_PROCES_DTD",
                      "type": "timestamp",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "columns_to_keep": "LNK_PREMIE_RGL_BETAAL_ID,LABEL_ID,COLLECTIVITEIT_OVEREENKOMST_ID,PRODUCTSET_SOORT_ID,BOUWSTEEN_ID,INGANG_DTM,EIND_DTM,BETAAL_TERMIJN_ID,BETAALTERMIJN_PCT,EDWH_RESOURCE_ID,EDWH_PEIL_DTM,EDWH_VERWIJDER_DTD,EDWH_PROCES_DTD",
            "history_key": "LNK_PREMIE_RGL_BETAAL_ID",
            "keep_deleted": false,
            "max_value_field": "",
            "snapshot_date": {
              "expression": "CZ_SAS_HUIDIGE_SITUATIE(expr('$SYSPEILDATUM'))",
              "format": "sql"
            },
            "snapshot_date_format": "yyyy-MM-dd"
          },
          "componentInfo": {
            "gemId": "gems/SnapshotFromHistory",
            "projectName": "cz-prophecy-dev"
          }
        },
        "t48_1": {
          "id": "t48_1",
          "component": "Join",
          "metadata": {
            "label": "Join_7",
            "slug": "Join_7",
            "phase": 48,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "betaaltermijn\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AQW\nOriginal transform name: Join\nOriginal output dataset names:\n- met_bet_term"
          },
          "ports": {
            "inputs": [
              {
                "id": "p48_1",
                "slug": "met_eigen_prod"
              },
              {
                "id": "p48_2",
                "slug": "snap_bet_term"
              }
            ],
            "outputs": [
              {
                "id": "p48_3",
                "slug": "met_bet_term"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "conditions": [
              {
                "alias": "snap_bet_term",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.COLLECTIVITEIT_OVEREENKOMST_ID <=> snap_bet_term.COLLECTIVITEIT_OVEREENKOMST_ID AND met_eigen_prod.PRODUCTSET_SOORT_ID <=> snap_bet_term.PRODUCTSET_SOORT_ID AND met_eigen_prod.BOUWSTEEN_ID <=> snap_bet_term.BOUWSTEEN_ID AND met_eigen_prod.BETAAL_TERMIJN_ID <=> snap_bet_term.BETAAL_TERMIJN_ID AND COALESCE(met_eigen_prod.INGANG_DTM, CAST ('0001-01-01' AS DATE)) <= COALESCE(snap_bet_term.EIND_DTM, CAST ('0001-01-01' AS DATE)) AND COALESCE(met_eigen_prod.EIND_DTM, CAST ('0001-01-01' AS DATE)) >= COALESCE(snap_bet_term.INGANG_DTM, CAST ('0001-01-01' AS DATE))"
                },
                "joinType": "left_outer"
              }
            ],
            "expressions": [
              {
                "target": "ASSURANTIE_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.ASSURANTIE_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BETAALTERMIJN_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "snap_bet_term.BETAALTERMIJN_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BETAAL_TERMIJN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.BETAAL_TERMIJN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BOUWSTEEN_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.BOUWSTEEN_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BRN_PERSOON_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.BRN_PERSOON_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BUITENLAND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.BUITENLAND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "BUITENLAND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.BUITENLAND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.COLLECTIVITEIT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.COLLECTIVITEIT_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COLLECTIVITEIT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.COLLECTIVITEIT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "COMMERCIELE_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.COMMERCIELE_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "DETENTIE_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.DETENTIE_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EDWH_RESOURCE_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.EDWH_RESOURCE_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_PRODUCT_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.EIGEN_PRODUCT_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_PRODUCT_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.EIGEN_PRODUCT_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.EIGEN_RISICO_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.EIGEN_RISICO_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIGEN_RISICO_REGELING_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.EIGEN_RISICO_REGELING_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "EIND_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "LEAST(met_eigen_prod.EIND_DTM, snap_bet_term.EIND_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.ER_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ER_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.ER_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GEBOORTE_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.GEBOORTE_DTM"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "GESLACHT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.GESLACHT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "INGANG_DTM",
                "expression": {
                  "format": "sql",
                  "expression": "GREATEST(met_eigen_prod.INGANG_DTM, snap_bet_term.INGANG_DTM)"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LABEL_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LABEL_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LAND_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LAND_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_TOT_MET"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_BL",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_TOT_MET_BL"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_TOT_MET_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_TOT_MET_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_VAN"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_BL",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_VAN_BL"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LEEFTIJD_VAN_ER",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LEEFTIJD_VAN_ER"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_COMM_TOESLAG_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LFT_COMM_TOESLAG_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "LFT_FABRIEKSPRIJS_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.LFT_FABRIEKSPRIJS_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PAKKET_KORTING_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.PAKKET_KORTING_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.PREMIE_AFWIJKEND_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PREMIE_AFWIJKEND_PCT",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.PREMIE_AFWIJKEND_PCT"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "PRODUCTSET_SOORT_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.PRODUCTSET_SOORT_ID"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "REFERENTIEPREMIE_BDG",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.REFERENTIEPREMIE_BDG"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZEKERING_IDC",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.ZORGVERZEKERING_IDC"
                },
                "description": "",
                "_row_id": ""
              },
              {
                "target": "ZORGVERZ_OVEREENKOMST_ID",
                "expression": {
                  "format": "sql",
                  "expression": "met_eigen_prod.ZORGVERZ_OVEREENKOMST_ID"
                },
                "description": "",
                "_row_id": ""
              }
            ],
            "hints": [
              {
                "id": "p48_1",
                "alias": "met_eigen_prod",
                "hintType": "none",
                "propagateColumns": false
              },
              {
                "id": "p48_2",
                "alias": "snap_bet_term",
                "hintType": "none",
                "propagateColumns": false
              }
            ],
            "allIn1": null,
            "activeTab": "conditions",
            "columnsSelector": [],
            "allIn0": null,
            "whereClause": null,
            "headAlias": "met_eigen_prod"
          },
          "componentInfo": null
        },
        "t49_1": {
          "id": "t49_1",
          "component": "Target",
          "metadata": {
            "label": "target_tmp_hlp_afg_premie_blok__blokid",
            "slug": "target_tmp_hlp_afg_premie_blok__blokid",
            "phase": 49,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [
              {
                "id": "p49_1",
                "slug": "TMP_HLP_AFG_PREMIE_BLOK"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_hlp_tmp_hlp_afg_premie_blok__blokid"
          },
          "componentInfo": null
        }
      }
    },
    "t51_1": {
      "id": "t51_1",
      "component": "TableIterator",
      "metadata": {
        "label": "Loop_1",
        "slug": "Loop_1",
        "phase": 51,
        "cache": false,
        "detailedStats": false,
        "isImported": false,
        "configPathInPipelineConfig": [
          "Loop_1"
        ]
      },
      "ports": {
        "inputs": [
          {
            "id": "p51_1",
            "slug": "blokgrootte"
          }
        ],
        "outputs": [],
        "selectedInputFields": [],
        "isCustomOutputSchema": false
      },
      "properties": {
        "metagemProperty": {
          "availableColumnNames": [
            "BLOKNUMMER"
          ],
          "availableConfigFieldNames": [
            "NUMMER"
          ],
          "numberOfThreads": "1",
          "maxIteration": "999999999",
          "parallelismEnabled": false,
          "configToColumnMap": [
            {
              "configName": "NUMMER",
              "columnName": "BLOKNUMMER"
            }
          ]
        }
      },
      "componentInfo": {
        "gemId": "gitUri=http://gitserver:3000/XIUGo8J6_team_2/XIUGo8J6_project_4.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=4&path=gems/TableIterator",
        "projectName": "ProphecySparkBasicsPython"
      },
      "connections": [
        {
          "id": "c_98",
          "source": "t51_1",
          "sourcePort": "p51_1",
          "target": "t51_cfi_1",
          "targetPort": "p51_cfi_1"
        },
        {
          "id": "c_95",
          "source": "t53_3",
          "sourcePort": "p53_4",
          "target": "t53_2",
          "targetPort": "p53_2"
        },
        {
          "id": "c_96",
          "source": "t53_1",
          "sourcePort": "p53_1",
          "target": "t53_3",
          "targetPort": "p53_3"
        },
        {
          "id": "c_97",
          "source": "t53_1",
          "sourcePort": "p53_1",
          "target": "t54_2",
          "targetPort": "p54_2"
        }
      ],
      "processes": {
        "t51_cfi_1": {
          "id": "t51_cfi_1",
          "component": "ControlFlowInput",
          "metadata": {
            "label": "TableIterator_Input",
            "slug": "TableIterator_Input",
            "phase": 0,
            "cache": false,
            "detailedStats": false,
            "isImported": false,
            "visualProperty": {
              "isHidden": true
            }
          },
          "ports": {
            "inputs": [
              {
                "id": "p51_cfi_1",
                "slug": "blokgrootte"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "minNumberOfInPorts": 1,
            "allowOutportAddDelete": true,
            "description": "",
            "allowInportAddDelete": true,
            "minNumberOfOutPorts": 0,
            "allowOutportRename": true,
            "allowInportRename": true
          },
          "componentInfo": null
        },
        "t51_cfo_1": {
          "id": "t51_cfo_1",
          "component": "ControlFlowOutput",
          "metadata": {
            "label": "TableIterator_Output",
            "slug": "TableIterator_Output",
            "phase": 0,
            "cache": false,
            "detailedStats": false,
            "isImported": false,
            "visualProperty": {
              "isHidden": true
            }
          },
          "ports": {
            "inputs": [],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "minNumberOfInPorts": 0,
            "allowOutportAddDelete": true,
            "description": "",
            "allowInportAddDelete": true,
            "minNumberOfOutPorts": 0,
            "allowOutportRename": true,
            "allowInportRename": true
          },
          "componentInfo": null
        },
        "t52_1": {
          "id": "t52_1",
          "component": "Script",
          "metadata": {
            "label": "User_Written_2",
            "slug": "User_Written_2",
            "phase": 52,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "%LET blokid = &NUMMER;\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AR0\nOriginal transform name: User Written\nOriginal output dataset names:\n- W6KJO2Z"
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p52_1",
                "slug": "User_Written",
                "schema": {
                  "type": "struct",
                  "fields": []
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "script": "# Original transform id: A5H5U7VN.BX005AR0\n# Original transform name: User Written\n# Original transform description: %LET blokid = &NUMMER;\n# \n# Auto-generated input/output variables.\n# Variables for output ports\n_output = '_OUTPUT'\nblokid = nummer\n# Auto-generated variables.\n# Variables for output ports\nUser_Written = spark.table(\"_OUTPUT\")",
            "scriptMethodHeader": null,
            "scriptMethodFooter": null
          },
          "componentInfo": null
        },
        "t53_1": {
          "id": "t53_1",
          "component": "Source",
          "metadata": {
            "label": "source_tmp_hlp_afg_premie_blok__blokid",
            "slug": "source_tmp_hlp_afg_premie_blok__blokid",
            "phase": 53,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [],
            "outputs": [
              {
                "id": "p53_1",
                "slug": "TMP_HLP_AFG_PREMIE_BLOK"
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_hlp_tmp_hlp_afg_premie_blok__blokid"
          },
          "componentInfo": null
        },
        "t53_2": {
          "id": "t53_2",
          "component": "Target",
          "metadata": {
            "label": "target_hlp_afg_premie",
            "slug": "target_hlp_afg_premie",
            "phase": 53,
            "cache": false,
            "detailedStats": false,
            "isImported": true
          },
          "ports": {
            "inputs": [
              {
                "id": "p53_2",
                "slug": "HLP_AFG_PREMIE"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": false
          },
          "properties": {
            "datasetId": "datasets/hlp_afg_premie_il_hlp_hlp_afg_premie"
          },
          "componentInfo": null
        },
        "t53_3": {
          "id": "t53_3",
          "component": "Script",
          "metadata": {
            "label": "User_Written_3",
            "slug": "User_Written_3",
            "phase": 53,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Appenden TMP\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AR1\nOriginal transform name: User Written\nOriginal output dataset names:\n- HLP_AFG_PREMIE"
          },
          "ports": {
            "inputs": [
              {
                "id": "p53_3",
                "slug": "TMP_HLP_AFG_PREMIE_BLOK"
              }
            ],
            "outputs": [
              {
                "id": "p53_4",
                "slug": "HLP_AFG_PREMIE",
                "schema": {
                  "type": "struct",
                  "fields": [
                    {
                      "name": "BRN_PERSOON_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GEBOORTE_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "GESLACHT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PRODUCTSET_SOORT_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BOUWSTEEN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LABEL_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZ_OVEREENKOMST_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAAL_TERMIJN_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_REGELING_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LAND_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "INGANG_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIND_DTM",
                      "type": "date",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ZORGVERZEKERING_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "REFERENTIEPREMIE_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COMMERCIELE_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EDWH_RESOURCE_ID",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LFT_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PREMIE_AFWIJKEND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "COLLECTIVITEIT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "PAKKET_KORTING_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN_ER",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET_ER",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_FABRIEKSPRIJS_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ER_COMM_TOESLAG_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_RISICO_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "ASSURANTIE_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_VAN_BL",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "LEEFTIJD_TOT_MET_BL",
                      "type": "integer",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BUITENLAND_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BUITENLAND_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_PRODUCT_BDG",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "EIGEN_PRODUCT_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "BETAALTERMIJN_PCT",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    },
                    {
                      "name": "DETENTIE_IDC",
                      "type": "double",
                      "nullable": true,
                      "metadata": {}
                    }
                  ]
                }
              }
            ],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "script": "# Original transform id: A5H5U7VN.BX005AR1\n# Original transform name: User Written\n# Original transform description: Appenden TMP\n# \n# Auto-generated input/output variables.\n# Variables for input ports\nTMP_HLP_AFG_PREMIE_BLOK.createOrReplaceTempView('_INPUT')\n_input = '_INPUT'\nTMP_HLP_AFG_PREMIE_BLOK.createOrReplaceTempView('_INPUT1')\n_input1 = '_INPUT1'\n# Variables for output ports\n_output = '_OUTPUT'\n# Original code:\n#  \n# %MACRO VULLEN_TEMP;\n#     /* Bij de eerste nieuw aanmaken */\n#     %IF &BLOKID = 1 %THEN %DO;\n#        data &_OUTPUT.(%unquote(&_OUTPUT_options));\n#           set &_INPUT;\n#        run;\n#     %END;\n#     /* Anders appenden */\n#     %ELSE %DO;\n#        proc append base=&_OUTPUT.(%unquote(&_OUTPUT_options)) data=&_INPUT;\n#        run;\n#     %END;\n# %MEND;\n# \n# %VULLEN_TEMP;\n#\n# Auto-generated variables.\n# Variables for output ports\nHLP_AFG_PREMIE = spark.table(\"_OUTPUT\")",
            "scriptMethodHeader": null,
            "scriptMethodFooter": null
          },
          "componentInfo": null
        },
        "t54_2": {
          "id": "t54_2",
          "component": "Script",
          "metadata": {
            "label": "Verwijder_tabellen_library_input",
            "slug": "Verwijder_tabellen_library_input",
            "phase": 54,
            "cache": false,
            "detailedStats": false,
            "isImported": true,
            "comment": "Verwijder tabellen library input\n\n### GEM Origin Info (SAS) ###\nOriginal transform id: A5H5U7VN.BX005AR2\nOriginal transform name: Verwijder tabellen library input\nNo output datasets"
          },
          "ports": {
            "inputs": [
              {
                "id": "p54_2",
                "slug": "TMP_HLP_AFG_PREMIE_BLOK"
              }
            ],
            "outputs": [],
            "selectedInputFields": [],
            "isCustomOutputSchema": true
          },
          "properties": {
            "script": "# Original transform id: A5H5U7VN.BX005AR2\n# Original transform name: Verwijder tabellen library input\n# Original transform description: Verwijder tabellen library input\n# \n# Auto-generated input/output variables.\n# Variables for input ports\nTMP_HLP_AFG_PREMIE_BLOK.createOrReplaceTempView('_INPUT')\n_input = '_INPUT'\nTMP_HLP_AFG_PREMIE_BLOK.createOrReplaceTempView('_INPUT1')\n_input1 = '_INPUT1'\nverwijdertabellenlibraryinput()\n# Auto-generated variables.",
            "scriptMethodHeader": null,
            "scriptMethodFooter": null
          },
          "componentInfo": null
        }
      }
    }
  },
  "ports": {
    "inputs": [],
    "outputs": [],
    "selectedInputFields": [],
    "isCustomOutputSchema": false
  }
}