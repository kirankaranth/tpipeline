{"initCode": "", "code": "\"\"\" UDF cz_sas_br_creeer_incasso_fase_code\nRULE_ID     = 21\nRULE_PARMS  = null\nRULE_NAME   = BR_CREEER_INCASSO_FASE_CODE\nRULE_TYPE   = Functional\nRULE_TEXT   = Cre\u00eber incasso fase code\nENVIRONMENT = D\nSTATUS      = A\nRULE_CODE   =\n    CASE\n        WHEN AANMANING_ZWAARTE_CODE > 5 AND DOSSIER_IDC = 1 THEN 5\n        WHEN AANMANING_ZWAARTE_CODE > 5 AND DOSSIER_IDC = . THEN 4\n        ELSE AANMANING_ZWAARTE_CODE\n    END\n\nBut for real, RULE_PARMS are: AANMANING_ZWAARTE_CODE,DOSSIER_IDC\n\nThe problem also is with\nTypeError: '>' not supported between instances of 'NoneType' and 'int'\n\"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import DoubleType\n\n\n@udf(returnType=DoubleType())\ndef cz_sas_br_creeer_incasso_fase_code(\n    aanmaning_zwaarte_code: float, dossier_idc: float\n) -> float:\n    if aanmaning_zwaarte_code is None:\n        return None\n    if aanmaning_zwaarte_code > 5 and dossier_idc == 1:\n        return 5.0\n    if aanmaning_zwaarte_code > 5 and dossier_idc is None:\n        return 4.0\n    return aanmaning_zwaarte_code\n"}