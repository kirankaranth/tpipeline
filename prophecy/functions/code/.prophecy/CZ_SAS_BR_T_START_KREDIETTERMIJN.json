{"initCode":"","code":"\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# Auto-generated pyspark code:\nfrom datetime import datetime\nimport calendar\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import DateType\n\n\n@udf(returnType=DateType())\ndef cz_sas_br_t_start_krediettermijn(dc_nota_categorie, ontstaan_dtm):\n    if dc_nota_categorie in [\n        \"Zorgverzekering\",\n        \"Aanvullende verz.\",\n        \"Ziektekosten\",\n        \"Ziekenfonds\",\n    ]:\n        if ontstaan_dtm is not None:\n            year, month = ontstaan_dtm.year, ontstaan_dtm.month\n            new_month = month % 12 + 1\n            new_year = year + (month + 1) // 13\n            last_day_of_new_month = calendar.monthrange(new_year, new_month)[1]\n            result_date = datetime(new_year, new_month, last_day_of_new_month)\n        else:\n            result_date = None\n    else:\n        result_date = ontstaan_dtm\n    return result_date\n"}