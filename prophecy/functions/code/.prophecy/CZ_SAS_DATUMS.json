{"initCode":"","code":"\"\"\" UDF CZ_SAS_DATUMS \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import DateType\n\n\n@udf(returnType=DateType())\ndef cz_sas_datums(value: str):\n    # pylint: disable=import-outside-toplevel\n    from datetime import datetime as dt\n\n    result = dt.strptime(\"99991231\", \"%Y%m%d\").date()\n    value = \"\" if not value else value\n\n    try:\n        return dt.strptime(value, \"%Y%m%d\").date()\n    except ValueError:\n        pass\n\n    try:\n        return dt.strptime(value, \"%d%m%Y\").date()\n    except ValueError:\n        return result\n"}