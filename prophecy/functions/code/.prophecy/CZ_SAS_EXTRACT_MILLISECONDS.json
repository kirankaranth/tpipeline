{"initCode":"","code":"\"\"\" UDF \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import IntegerType\n\n\n@udf(returnType=IntegerType())\ndef cz_sas_extract_milliseconds(datetime_str):\n    # pylint: disable=import-outside-toplevel\n    from datetime import datetime\n\n    dt = datetime.strptime(datetime_str, \"%Y-%m-%d %H:%M:%S.%f\")\n    milliseconds = dt.microsecond // 1000\n    return milliseconds\n"}