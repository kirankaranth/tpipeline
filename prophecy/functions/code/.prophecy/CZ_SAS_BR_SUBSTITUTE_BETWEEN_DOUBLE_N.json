{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_substitute_between_double_n(source_str, pattern):\n    res_string = \"\"\n    if source_str is None:\n        return None\n\n    if pattern[0] == \"A\":\n        res_string += chr(26)\n    else:\n        res_string += source_str[0]\n    if len(source_str) > 1:\n        for j in range(1, len(source_str) - 1):\n            if (\n                not ((pattern[j - 1] == \"N\") and (pattern[j + 1] == \"N\"))\n                and pattern[j] == \"A\"\n            ):\n                res_string += chr(26)\n            else:\n                res_string += source_str[j]\n        if pattern[len(source_str) - 1] == \"A\":\n            res_string += chr(26)\n        else:\n            res_string += source_str[len(source_str) - 1]\n\n    return res_string\n"}