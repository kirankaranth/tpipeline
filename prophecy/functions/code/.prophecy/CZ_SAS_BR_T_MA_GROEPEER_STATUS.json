{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# Auto-generated pyspark code:\nimport re\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_ma_groepeer_status(status):\n    patterns = [\n        (r\"Dossier toegewezen aan\", lambda m: m.group(0)),\n        (r\"Collectiviteitsnummer gewijzigd naar\", lambda m: m.group(0)),\n        (r\"Gedelegeerd aan\", lambda m: m.group(0)),\n        (r\"Naar status Proces in de toekomst\", lambda m: m.group(0)),\n        (r\"Relatienummer gewijzigd naar\", \"Relatienummer gewijzigd naar\"),\n        (r\"Relatienummer \\d+? vervallen\", \"Relatienummer vervallen\"),\n        (r\"Subproces gewijzigd naar\", \"Subproces gewijzigd naar\"),\n        (r\"Ontkoppeld van dossiernummer\", \"Ontkoppeld van dossiernummer\"),\n        (r\"Groep gewijzigd naar\", \"Groep gewijzigd naar\"),\n        (r\"Naar status Proces afgehandeld\", \"Naar status Proces afgehandeld\"),\n        (r\"Subproces \\D+? vervallen\", \"Subproces vervallen\"),\n        (r\"Extra informatie opgevraagd\", \"Extra informatie opgevraagd\"),\n        (r\"Aanvrager .* vervallen\", \"Aanvrager vervallen\"),\n        (r\"Aanvrager gewijzigd\", \"Aanvrager gewijzigd\"),\n        (r\"Proces in de toekomst\", \"Proces in de toekomst\"),\n        (r\"Uitvoerder .* vervallen\", \"Uitvoerder vervallen\"),\n        (r\"Uitvoerder gewijzigd naar\", \"Uitvoerder gewijzigd\"),\n        (r\"Toegewezen aan\", \"Toegewezen aan\"),\n    ]\n\n    for pattern, replacement in patterns:\n        match = re.match(pattern, status)\n        if match:\n            if callable(replacement):\n                return replacement(match).strip()\n            return replacement\n    return status.strip()\n"}