{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n\n# case when index(&Aktiviteit.,\" aan \") > 0 and index(&Aktiviteit.,\" naar \") = 0\n# then substr(&Aktiviteit.,1, index(&Aktiviteit.,\" aan \"))\n# when index(&Aktiviteit.,\" naar \") > 0 and index(&Aktiviteit.,\" aan \") = 0\n# then substr(&Aktiviteit.,1, index(&Aktiviteit.,\" naar \"))\n# when min(index(&Aktiviteit.,\" aan \"), index(&Aktiviteit.,\" naar \")) > 0\n# then substr(&Aktiviteit.,1, min(index(&Aktiviteit.,\" aan \"), index(&Aktiviteit.,\" naar \")))\n# else &Aktiviteit. end\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_email_aktiviteit(aktivitet) -> str:\n    if aktivitet is None:\n        return None\n\n    index_aan = aktivitet.find(\" aan \")\n    index_naar = aktivitet.find(\" naar \")\n\n    if index_aan > 0 and index_naar == -1:\n        return aktivitet[:index_aan]\n    if index_naar > 0 and index_aan == -1:\n        return aktivitet[:index_naar]\n    if index_aan > 0 and index_naar > 0:\n        ind = index_aan if index_aan < index_naar else index_naar\n        return aktivitet[:ind]\n    return aktivitet\n"}