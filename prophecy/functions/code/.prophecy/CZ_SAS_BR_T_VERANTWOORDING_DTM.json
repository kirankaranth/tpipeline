{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# case when &PRO_GTB. = '010101' then &VERRICHTING_INGANG_DTM. else input (&PRO_GTB.||'01', yymmdd8.) end\n# Auto-generated pyspark code:\nimport datetime\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n# cz_sas_br_t_verantwoording_dtm\n# SAS Code: case when &PRO_GTB. = '010101' then &VERRICHTING_INGANG_DTM.\n# else input (&PRO_GTB.||'01', yymmdd8.) end\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_verantwoording_dtm(pro_gtb, verrichting_ingang_dtm) -> str:\n    def sas_date_to_datetime(sas_date_str):\n        if len(sas_date_str) == 6 and sas_date_str.isdigit():\n            try:\n                return datetime.datetime.strptime(sas_date_str + \"01\", \"%y%m%d\")\n            except ValueError:\n                return None\n        else:\n            return None\n\n    if pro_gtb == \"010101\":\n        result = str(verrichting_ingang_dtm)\n    else:\n        datetime_obj = sas_date_to_datetime(pro_gtb)\n        result = datetime_obj.strftime(\"%Y-%m-%d\") if datetime_obj else \"\"\n    return result\n"}