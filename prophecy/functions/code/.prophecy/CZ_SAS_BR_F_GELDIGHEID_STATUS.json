{"initCode": "", "code": "\"\"\" UDF cz_sas_br_f_geldigheid_status\"\"\"\n\nfrom pyspark.sql.types import IntegerType\nfrom pyspark.sql.functions import udf\n\n\n@udf(returnType=IntegerType())\ndef cz_sas_br_f_geldigheid_status(peildatum, ingang_dtm, eind_dtm):\n    # case\n    #     when &PEILDATUM BETWEEN &INGANG_DTM AND &EIND_DTM\n    #         then 1\n    #     when &EIND_DTM < &PEILDATUM\n    #         then 2\n    #     when &INGANG_DTM > &PEILDATUM\n    #         then 3\n    #     when &INGANG_DTM = &EIND_DTM\n    #         then 4\n    #     else .\n    # end\n    result = None\n    if ingang_dtm < peildatum <= eind_dtm:\n        result = 1\n    elif eind_dtm < peildatum:\n        result = 2\n    elif ingang_dtm > peildatum:\n        result = 3\n    elif ingang_dtm == eind_dtm:\n        result = 4\n    return result\n"}