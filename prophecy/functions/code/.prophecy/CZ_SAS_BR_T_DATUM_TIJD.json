{"initCode":"","code":"\"\"\" UDF cz_sas_br_t_datum_tijd \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import TimestampType\n\n\n@udf(returnType=TimestampType())\ndef cz_sas_br_t_datum_tijd(datumveld: str, tijdveld: str):\n    # pylint: disable=import-outside-toplevel\n    from datetime import datetime, timedelta\n\n    try:\n        if (\n            (datumveld is None)\n            or (tijdveld is None)\n            or (tijdveld == \"  0000\")\n            or (len(tijdveld) != 6 and tijdveld != \"00002\")\n        ):\n            return None\n\n        # Parse the date (datumveld) in 'YYYYMMDD' format\n        date_part = datetime.strptime(datumveld, \"%Y%m%d\")\n\n        if tijdveld in (\"00.00.\", \"0.0000\"):\n            tijdveld = \"000000\"\n        # Extract time components from tijdveld\n        hours = int(tijdveld[0:2])\n        minutes = int(tijdveld[2:4])\n        seconds = int(tijdveld[4:6])\n\n        # Create a datetime object from the date and time components\n        datetime_part = date_part + timedelta(\n            hours=hours, minutes=minutes, seconds=seconds\n        )\n\n        return datetime_part\n    except Exception:\n        return None\n"}