{"initCode":"","code":"\"\"\" UDF cz_sas_br_substitute_double_a \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_substitute_double_a(source_str, pattern):\n    if source_str is None:\n        return None\n\n    res_string = source_str[0]\n    for j in range(1, len(source_str)):\n        if pattern[j - 1] == \"A\" and pattern[j] == \"A\":\n            res_string += chr(26)\n        else:\n            res_string += source_str[j]\n\n    return res_string\n"}