{"initCode": "", "code": "\"\"\" UDF cz_sas_br_t_cat_instelling \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import BooleanType\n\n\n@udf(returnType=BooleanType())\ndef cz_sas_br_t_cat_instelling(kde_tbl_tbs, std_tbs):\n    # Source condition\n    # \"KDE_TBL_TBS = '022'\n    # AND NOT (substr(STD_TBS,1,7) = '001858A'\n    # AND substr(STD_TBS,8,1) not in ('G', 'H', 'I'))\n    # AND substr(STD_TBS,1,7) IN  ( '001670M', '001670N', '001686J', '001686K', '001858A', '002737M', '002737N',\n    # '002737O', '002737P', '002737Q', '002737R', '002737S', '002737T', '002737U', '002737V',\n    # '002737W', '002737Y', '002737Z', '001686M')\n\n    return kde_tbl_tbs == \"022\" and (\n        ((\"001858A\" in std_tbs[0:7]) and std_tbs[7:8] in [\"G\", \"H\", \"I\"])\n        or (\n            std_tbs[0:7]\n            in [\n                \"001670M\",\n                \"001670N\",\n                \"001686J\",\n                \"001686K\",\n                \"002737M\",\n                \"002737N\",\n                \"002737O\",\n                \"002737P\",\n                \"002737Q\",\n                \"002737R\",\n                \"002737S\",\n                \"002737T\",\n                \"002737U\",\n                \"002737V\",\n                \"002737W\",\n                \"002737Y\",\n                \"002737Z\",\n                \"001686M\",\n            ]\n        )\n    )\n"}