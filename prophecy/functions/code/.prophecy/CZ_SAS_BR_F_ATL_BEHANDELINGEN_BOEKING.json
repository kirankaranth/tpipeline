{"initCode":"","code":"\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# IFN(&DECLARATIEBOEKING_SOORT_ID. in (2,6) and abs(&DECLARATIEBOEKING_BDG\n# Auto-generated pyspark code:\nfrom datetime import datetime\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import DoubleType\n\n\n@udf(returnType=DoubleType())\ndef cz_sas_br_f_atl_behandelingen_boeking(\n    declaratieboeking_soort_id,\n    declaratieboeking_bdg,\n    prestatiecodenr,\n    productgroep_code,\n    kostenrubriek_code,\n    declaratieboeking_dtm,\n    kostensoort_code,\n    schaderegel_categorie_id,\n    verzekeringgrondslag_code,\n    eigen_bijdrage_initieel_bdg,\n    prestatie_atl_br,\n    boeking_eenheden_atl,\n) -> float:\n    def signum(value):\n        return 1 if value > 0 else -1 if value < 0 else 0\n\n    if (\n        declaratieboeking_soort_id in (2, 6)\n        and abs(declaratieboeking_bdg) >= 0.001\n        and prestatiecodenr == 1\n        and productgroep_code\n        in (\n            \"DB\",\n            \"EP\",\n            \"FP\",\n            \"FY\",\n            \"GH\",\n            \"GP\",\n            \"HA\",\n            \"HC\",\n            \"HE\",\n            \"HM\",\n            \"HV\",\n            \"IB\",\n            \"MD\",\n            \"MR\",\n            \"NG\",\n            \"OM\",\n            \"SP\",\n            \"TA\",\n            \"TC\",\n            \"VO\",\n        )\n    ):\n        return signum(declaratieboeking_bdg)\n    if prestatiecodenr == 60 and abs(declaratieboeking_bdg) >= 0.001:\n        return signum(declaratieboeking_bdg)\n    if prestatiecodenr == 999 and abs(declaratieboeking_bdg) >= 0.001:\n        return signum(declaratieboeking_bdg)\n    if kostenrubriek_code == \"02\" and abs(declaratieboeking_bdg) >= 0.001:\n        return signum(declaratieboeking_bdg)\n    if (\n        declaratieboeking_dtm < datetime.strptime(\"23MAY22\", \"%d%b%y\")\n        and kostensoort_code in (\"658000\", \"568000\", \"640800\")\n        and schaderegel_categorie_id in (1, 6, 7)\n        and verzekeringgrondslag_code in (\"21\", \"24\", \"52\")\n        and eigen_bijdrage_initieel_bdg < 0\n    ):\n        return prestatie_atl_br\n    if (\n        declaratieboeking_dtm < datetime.strptime(\"23MAY22\", \"%d%b%y\")\n        and kostensoort_code == \"688000\"\n        and schaderegel_categorie_id in (1, 6, 7)\n        and verzekeringgrondslag_code in (\"21\", \"24\", \"52\")\n        and eigen_bijdrage_initieel_bdg < 0\n    ):\n        return prestatie_atl_br / 60\n    if declaratieboeking_soort_id == -2 or (\n        declaratieboeking_soort_id in (2, 6) and abs(declaratieboeking_bdg) >= 0.001\n    ):\n        return boeking_eenheden_atl\n    return 0\n"}