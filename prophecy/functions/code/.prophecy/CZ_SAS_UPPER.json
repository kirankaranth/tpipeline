{"initCode": "", "code": "\"\"\" UDF cz_sas_upper \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_upper(value: str):\n    if value is None:\n        return None\n\n    transformations = {\n        # '\u00df': '\u00df', '\u00ff': '\u00ff' in Unicode representation\n        chr(0xDF): chr(0xDF),  # '\u00df' to '\u00df'\n        chr(0xFF): chr(0xFF),  # '\u00ff' to '\u00ff'\n    }\n    return \"\".join([transformations.get(c, c.upper()) for c in value])\n"}