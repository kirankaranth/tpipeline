{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# Auto-generated pyspark code:\nfrom datetime import datetime\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_crmz_peildatum_vnestand(type_, syspeildatum):\n    if syspeildatum is None or not syspeildatum.strip():\n        return \"01JAN1800\"\n\n    try:\n        syspeildatum_dt = datetime.strptime(syspeildatum.strip(), \"%d%b%Y\")\n    except ValueError:\n        # Assuming 'syspeildatum' is in the correct format 'DDMMMYYYY', if not,\n        # return default value\n        return \"01JAN1800\"\n\n    type_upper = type_.upper() if type_ else \"\"\n    if type_upper == \"VORIG\":\n        result_date = syspeildatum_dt.replace(\n            day=31, month=12, year=syspeildatum_dt.year - 1\n        )\n    elif type_upper == \"HUIDIG\":\n        result_date = syspeildatum_dt.replace(day=31, month=12)\n    elif type_upper == \"VOLGEND\":\n        result_date = syspeildatum_dt.replace(\n            day=1, month=1, year=syspeildatum_dt.year + 1\n        )\n    else:\n        return \"01JAN1800\"\n\n    result_date_str = result_date.strftime(\"%d%b%Y\").upper()\n    return result_date_str\n"}