{"initCode":"","code":"\"\"\" UDF cz_sas_br_t_adres_status\n*=======================\n*== Original SQL code ==\n*=======================\nPOSTCODE,STRAATNAAM, LAND_CODE, ADRES_STATUS_CODE, VERSLEUTELD_IDC\n\nCASE\n    WHEN (&postcode  = '' AND INDEX(LOWCASE(&straatnaam),'onbekend')) THEN 1\n    WHEN (&postcode = '' AND LAND_CODE  = 'NL' AND INDEX(LOWCASE(&straatnaam),'geheim')) THEN  4\n    WHEN (&VERSLEUTELD_IDC = 1) THEN 6\n    WHEN &adres_status_code = 2 THEN 2\n    ELSE 5\nEND\n\"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import DoubleType\n\n\n@udf(returnType=DoubleType())\ndef cz_sas_br_t_adres_status(\n    postcode, straatnaam, land_code, adres_status_code, versleuteld_idc\n):\n    result = 5.0\n    postcode = postcode.strip() if postcode else \"\"\n    straatnaam = straatnaam.strip() if straatnaam else \"\"\n    land_code = land_code.strip() if land_code else \"\"\n\n    if postcode.strip() == \"\" and \"onbekend\" in straatnaam.lower():\n        result = 1.0\n    elif (\n        postcode.strip() == \"\"\n        and land_code.strip() == \"NL\"\n        and \"geheim\" in straatnaam.lower()\n    ):\n        result = 4.0\n    elif versleuteld_idc and versleuteld_idc == 1.0:\n        result = 6.0\n    elif adres_status_code and adres_status_code == 2.0:\n        result = 2.0\n    else:\n        result = 5.0\n\n    return result\n"}