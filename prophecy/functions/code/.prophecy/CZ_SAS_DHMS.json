{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import TimestampType\n\n\n@udf(returnType=TimestampType())\ndef cz_sas_dhms(input_date, hours, minutes, seconds):\n    # pylint: disable=import-outside-toplevel\n    from datetime import date, timedelta, datetime\n\n    try:\n        if isinstance(input_date, (float, int)):\n            # If input_date is a float that represents in SAS the number of\n            # days since '1960-01-01'\n            days = input_date\n            delta = timedelta(days=days, seconds=seconds, minutes=minutes, hours=hours)\n            base_date = datetime(1960, 1, 1)\n            return base_date + delta\n\n        if isinstance(input_date, date):\n            # If input_date is date as ordinary date type\n            days = input_date.day\n            months = input_date.month\n            years = input_date.year\n\n            delta = timedelta(\n                hours=float(hours), minutes=float(minutes), seconds=float(seconds)\n            )\n            dt = datetime(years, months, days)\n\n            return dt + delta\n\n        # If input_date is in any other format, return None\n        return None\n\n    except Exception:\n        return None\n"}