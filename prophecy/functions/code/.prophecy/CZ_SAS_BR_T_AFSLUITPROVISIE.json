{"initCode": "", "code": "\"\"\" UDF cz_sas_br_t_afsluitprovisie \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import DoubleType\n\n\n@udf(DoubleType())\ndef cz_sas_br_t_afsluitprovisie(\n    recht_op_afsluitprovisie_idc,\n    provisie_rgl_type_code,\n    provisie_regeling_bdg,\n    provisie_premievrije_verz_idc,\n    netto_premie_bdg,\n    provisie_regeling_pct,\n):\n    provisie_regeling_bdg = (\n        provisie_regeling_bdg if provisie_regeling_bdg is not None else 0.0\n    )\n    netto_premie_bdg = netto_premie_bdg if netto_premie_bdg is not None else 0.0\n    provisie_regeling_pct = (\n        provisie_regeling_pct if provisie_regeling_pct is not None else 0.0\n    )\n\n    if (\n        recht_op_afsluitprovisie_idc == 1\n        and provisie_rgl_type_code == \"AP\"\n        and provisie_regeling_bdg > 0\n        and (provisie_premievrije_verz_idc == 1 or netto_premie_bdg > 0.005)\n    ):\n        return provisie_regeling_bdg\n    if (\n        recht_op_afsluitprovisie_idc == 1\n        and provisie_rgl_type_code == \"AP\"\n        and provisie_regeling_pct > 0\n        and (provisie_premievrije_verz_idc == 1 or netto_premie_bdg > 0.005)\n    ):\n        return (provisie_regeling_pct / 100) * netto_premie_bdg\n    return 0.0\n"}