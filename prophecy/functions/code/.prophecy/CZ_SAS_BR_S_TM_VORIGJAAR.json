{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# put(YEAR(TODAY())-1, z4.)  <= &JAAR.  AND &DATUM.  <= TODAY()\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import BooleanType\n\n\n@udf(returnType=BooleanType())\ndef cz_sas_br_s_tm_vorigjaar(datum, jaar, today) -> bool:\n    # pylint: disable=import-outside-toplevel\n    # from datetime import date\n\n    current_year_minus_one = str(today.year - 1)\n    # today = date.today()\n\n    return (current_year_minus_one <= jaar) and ((datum is None) or (datum <= today))\n"}