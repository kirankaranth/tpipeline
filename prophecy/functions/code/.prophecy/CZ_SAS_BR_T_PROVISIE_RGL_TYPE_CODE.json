{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_provisie_rgl_type_code(\n    pct_cpv: float, bgd_cpv: float, pct_aps: float, bgd_aps: float\n) -> str:\n    try:\n        if pct_cpv > 0 or bgd_cpv > 0:\n            result = \"CP\"\n        elif pct_aps > 0 or bgd_aps > 0:\n            result = \"AP\"\n        else:\n            result = \"CP\"\n\n        return result\n\n    except Exception as e:\n        print(f\"An exception occurred: {str(e)}\")\n\n        return \"\"\n"}