{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# Auto-generated pyspark code:\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_email_status(statusoms):\n    if statusoms is None:\n        return None\n    statusoms_lower = statusoms.lower()\n    if \"emailbericht\" in statusoms_lower:\n        start_index = statusoms_lower.find(\"emailbericht\")\n        if start_index == 0:\n            naar_index = statusoms_lower.find(\" naar\")\n            if naar_index != -1:\n                result = statusoms[start_index + len(\"emailbericht\") + 1 : naar_index]\n            else:\n                result = statusoms[start_index + len(\"emailbericht\") + 1 :]\n        else:\n            result = (\n                statusoms[:start_index]\n                + statusoms[start_index + len(\"emailbericht\") + 1 :]\n            )\n    else:\n        result = statusoms\n    return result.replace(\" \", \"#\")\n"}