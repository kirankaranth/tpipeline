{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# Auto-generated pyspark code:\nimport re\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n\n# Business Rule: cz_sas_br_t_postcode\n# SAS Code:\n# ifc (translate (upcase (compress (&postcode.)),\n#                 repeat ('#', 9) || repeat ('$', 25),\n#                 collate (48, 57) || collate (65, 90)) = '####$$',\n#     &postcode., '')\n\n\n@udf(returnType=StringType())\ndef cz_sas_br_t_postcode(postcode):\n    if postcode is None:\n        return \"\"\n    postcode_compressed = re.sub(\"[\\\\s+-]\", \"\", postcode.upper())\n    translated = postcode_compressed.translate(\n        str.maketrans(\n            \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\", \"#########$$$$$$$$$$$$$$$$$$$$$\"\n        )\n    )\n    if translated == \"####$$\":\n        return postcode\n    return \"\"\n"}