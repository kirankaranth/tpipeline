{"initCode": "", "code": "\"\"\" UDF \"\"\"\n\n# Original SAS code:\n# case when &SCHADE_PRODUCTIESTRAAT_CODE = '1' and &ZORGVERLENER_INSTELLING_ID > 0\n# and substr(&VERRICHTING_SUBSOORT_CODE,3,2)\n# not in ('53','94','95') then &ZORGVERLENER_INSTELLING_ID when  &SCHADE_PRODUCTIESTRAAT_CODE = '3'\n# then &ZORGVERLENER_DECLARANT_ID\n# else &ZORGVERLENER_UITSCHRIJVER_ID end\n# Auto-generated pyspark code:\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import IntegerType\n\n\n@udf(returnType=IntegerType())\ndef cz_sas_br_t_bepaal_zorgverlener_id(\n    schade_productiestraat_code,\n    zorgverlener_instelling_id,\n    verrichting_subsoort_code,\n    zorgverlener_declarant_id,\n    zorgverlener_uitschrijver_id,\n) -> int:\n    if (\n        schade_productiestraat_code == \"1\"\n        and zorgverlener_instelling_id > 0\n        and verrichting_subsoort_code[2:4] not in (\"53\", \"94\", \"95\")\n    ):\n        return zorgverlener_instelling_id\n    if schade_productiestraat_code == \"3\":\n        return zorgverlener_declarant_id\n    return zorgverlener_uitschrijver_id\n"}